

<!DOCTYPE html>
<html lang="en" color-mode=light>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>手撕代码 - 芝叶</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />
  
  <meta name="description" content="1.Object.create123456789101...">
  <meta name="author" content="芝叶">
  <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
    
<link rel="stylesheet" href="https://at.alicdn.com/t/font_1445822_p6ry5n7lrr.css">

  

  
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
    
      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css" name="highlight-style" mode="light">

      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="dark">

      
  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      isHome: false,
      fancybox: true,
      pjax: false,
      loading: {
        gif: '/images/theme/loading.gif',
        lottie: ''
      },
      lazyload: {
        enable: true,
        only_post: 'false',
        loading: {
          gif: '/images/theme/loading.gif',
          lottie: ''
        }
      },
      donate: {
        enable: false,
        alipay: 'https://pic.izhaoo.com/alipay.jpg',
        wechat: 'https://pic.izhaoo.com/wechat.jpg'
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        always_show: true
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: false
      },
      preview: {
        background: {
          default: '',
          api: ''
        },
        motto: {
          default: '我在开了灯的床头下，想问问自己的心啊。',
          typing: true,
          api: 'https://v2.jinrishici.com/one.json',
          data_contents: '["data","content"]'
        },
      },
      qrcode: {
        enable: false,
        type: 'url',
        image: 'https://pic.izhaoo.com/weapp-code.jpg',
      },
      toc: {
        enable: true
      },
      scrollbar: {
        type: 'default'
      },
      notification: {
        enable: false,
        delay: 4500,
        list: '',
        page_white_list: '',
        page_black_list: ''
      },
      search: {
        enable: true,
        path: 'search.xml'
      }
    }
  </script>

  

  

<meta name="generator" content="Hexo 6.2.0"></head>

<body class="lock-screen">
  <div class="loading" id="loading"></div>
  
    


  <nav class="navbar">
    <div class="left">
      
        <i class="iconfont iconhome j-navbar-back-home"></i>
      
      
      
        <i class="iconfont iconmoono" id="color-toggle" color-toggle="light"></i>
      
      
        <i class="iconfont iconsearch j-navbar-search"></i>
      
    </div>
    <div class="center">手撕代码</div>
    <div class="right">
      <i class="iconfont iconmenu j-navbar-menu"></i>
    </div>
    
  </nav>

  
  

<nav class="menu">
  <div class="menu-container">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content"><li class="menu-item">
        <a href="/ " class="underline "> 首页</a>
      </li><li class="menu-item">
        <a href="/archives " class="underline "> 归档</a>
      </li><li class="menu-item">
        <a href="/tags/ " class="underline "> 标签</a>
      </li><li class="menu-item">
        <a href="/html/game.html " class="underline "> 游戏</a>
      </li><li class="menu-item">
        <a href="/about/ " class="underline "> 关于</a>
      </li></ul>
    
      <div class="menu-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  <a target="_blank" href="https://github.com/Yeatsczx">CZX - 2022</a></p></div>
    
  </div>
</nav>
  <main id="main">
  <div class="article-wrap">
    <div class="row container">
      <div class="col-xl-3"></div>
      <div class="col-xl-6"><article class="article">
  <div class="wrap">
    <section class="head">
  <img   class="lazyload" data-original="/images/theme/preview8.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">手撕代码</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>April 10, 2023</span>
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>50778</span>
    </div>
  </div>
</section>
    <section class="main">
      <section class="content">
        
        <h2 id="1-Object-create"><a href="#1-Object-create" class="headerlink" title="1.Object.create"></a>1.Object.create</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//实现Object.create方法</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">proto</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">Fn</span>(<span class="hljs-params"></span>) &#123;&#125;;<br>    <span class="hljs-title class_">Fn</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = proto;<br>    <span class="hljs-title class_">Fn</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Fn</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fn</span>();<br>&#125;<br><span class="hljs-keyword">let</span> demo = &#123;<br>    c : <span class="hljs-string">&#x27;123&#x27;</span><br>&#125;<br><span class="hljs-keyword">let</span> cc = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(demo)<br></code></pre></td></tr></table></figure>

<h2 id="2-instanceof"><a href="#2-instanceof" class="headerlink" title="2.instanceof"></a>2.instanceof</h2><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myInstanceof</span>(<span class="hljs-literal">left</span>, <span class="hljs-literal">right</span>) &#123;<br>  while (<span class="hljs-literal">true</span>) &#123;<br>    if (<span class="hljs-literal">left</span> === null) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><span class="hljs-comment">;</span><br>    &#125;<br>    if (<span class="hljs-literal">left</span>.__proto__ === <span class="hljs-literal">right</span>.prototype) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><span class="hljs-comment">;</span><br>    &#125;<br>    <span class="hljs-literal">left</span> = <span class="hljs-literal">left</span>.__proto__<span class="hljs-comment">;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="3-new"><a href="#3-new" class="headerlink" title="3.new"></a>3.new</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span><span class="hljs-params">(fn, <span class="hljs-rest_arg">...args</span>)</span> &#123;<br>  let obj = Object.create(fn.prototype);<br>  let res = fn.call(obj, ...args);<br>  <span class="hljs-comment">//不需要考虑fn函数没有返回值的情况，因为函数没有return默认返回undefind，undefind不是对象，没有原型，res instanceof </span><br>  <span class="hljs-comment">// Object返回false</span><br>  <span class="hljs-keyword">if</span> (res <span class="hljs-keyword">instanceof</span> Object) &#123;<br>    <span class="hljs-keyword">return</span> res;<br>  &#125;<br>  <span class="hljs-keyword">return</span> obj;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-实现sleep"><a href="#4-实现sleep" class="headerlink" title="4.实现sleep"></a>4.实现sleep</h2><p>某个时间后就去执行某个函数，使用Promise封装</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-params">fn, time</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-title function_">resolve</span>(fn);<br>        &#125;, time);<br>    &#125;);<br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">autoPlay</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot; 我在sleep 之前&quot;</span>);<br>    <span class="hljs-comment">// 等待多少秒</span><br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(time);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot; 我在sleep 之后&quot;</span>);<br>&#125;<br><span class="hljs-title function_">autoPlay</span>()<br></code></pre></td></tr></table></figure>

<h2 id="5-Promise"><a href="#5-Promise" class="headerlink" title="5.Promise"></a>5.Promise</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Promise</span>(<span class="hljs-params">excutor</span>) &#123;<br>    <span class="hljs-keyword">let</span> that = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// 缓存当前promise实例对象</span><br>    that.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PENDING</span>; <span class="hljs-comment">// 初始状态</span><br>    that.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// fulfilled状态时 返回的信息</span><br>    that.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// rejected状态时 拒绝的原因</span><br>    that.<span class="hljs-property">onFulfilledCallbacks</span> = []; <span class="hljs-comment">// 存储fulfilled状态对应的onFulfilled函数</span><br>    that.<span class="hljs-property">onRejectedCallbacks</span> = []; <span class="hljs-comment">// 存储rejected状态对应的onRejected函数</span><br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">value</span>) &#123; <span class="hljs-comment">// value成功态时接收的终值</span><br>        <span class="hljs-keyword">if</span>(value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span>) &#123;<br>            <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">then</span>(resolve, reject);<br>        &#125;<br>        <span class="hljs-comment">// 实践中要确保 onFulfilled 和 onRejected 方法异步执行，且应该在 then 方法被调用的那一轮事件循环之后的新执行栈中执行。</span><br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-comment">// 调用resolve 回调对应onFulfilled函数</span><br>            <span class="hljs-keyword">if</span> (that.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PENDING</span>) &#123;<br>                <span class="hljs-comment">// 只能由pending状态 =&gt; fulfilled状态 (避免调用多次resolve reject)</span><br>                that.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">FULFILLED</span>;<br>                that.<span class="hljs-property">value</span> = value;<br>                that.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> <span class="hljs-title function_">cb</span>(that.<span class="hljs-property">value</span>));<br>            &#125;<br>        &#125;);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">reason</span>) &#123; <span class="hljs-comment">// reason失败态时接收的拒因</span><br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-comment">// 调用reject 回调对应onRejected函数</span><br>            <span class="hljs-keyword">if</span> (that.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PENDING</span>) &#123;<br>                <span class="hljs-comment">// 只能由pending状态 =&gt; rejected状态 (避免调用多次resolve reject)</span><br>                that.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">REJECTED</span>;<br>                that.<span class="hljs-property">reason</span> = reason;<br>                that.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> <span class="hljs-title function_">cb</span>(that.<span class="hljs-property">reason</span>));<br>            &#125;<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-comment">// 捕获在excutor执行器中抛出的异常</span><br>    <span class="hljs-comment">// new Promise((resolve, reject) =&gt; &#123;</span><br>    <span class="hljs-comment">//     throw new Error(&#x27;error in excutor&#x27;)</span><br>    <span class="hljs-comment">// &#125;)</span><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-title function_">excutor</span>(resolve, reject);<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-title function_">reject</span>(e);<br>    &#125;<br>&#125;<br><br><span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">then</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;<br>    <span class="hljs-keyword">const</span> that = <span class="hljs-variable language_">this</span>;<br>    <span class="hljs-keyword">let</span> newPromise;<br>    <span class="hljs-comment">// 处理参数默认值 保证参数后续能够继续执行</span><br>    onFulfilled =<br>        <span class="hljs-keyword">typeof</span> onFulfilled === <span class="hljs-string">&quot;function&quot;</span> ? onFulfilled : <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> value;<br>    onRejected =<br>        <span class="hljs-keyword">typeof</span> onRejected === <span class="hljs-string">&quot;function&quot;</span> ? onRejected : <span class="hljs-function"><span class="hljs-params">reason</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">throw</span> reason;<br>        &#125;;<br>    <span class="hljs-keyword">if</span> (that.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">FULFILLED</span>) &#123; <span class="hljs-comment">// 成功态</span><br>        <span class="hljs-keyword">return</span> newPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>                <span class="hljs-keyword">try</span>&#123;<br>                    <span class="hljs-keyword">let</span> x = <span class="hljs-title function_">onFulfilled</span>(that.<span class="hljs-property">value</span>);<br>                    x <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span> ? x.<span class="hljs-title function_">then</span>(resolve, reject) : <span class="hljs-title function_">resolve</span>(x);<br>                &#125; <span class="hljs-keyword">catch</span>(e) &#123;<br>                    <span class="hljs-title function_">reject</span>(e); <span class="hljs-comment">// 捕获前面onFulfilled中抛出的异常 then(onFulfilled, onRejected);</span><br>                &#125;<br>        &#125;)<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (that.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">REJECTED</span>) &#123; <span class="hljs-comment">// 失败态</span><br>        <span class="hljs-keyword">return</span> newPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">let</span> x = <span class="hljs-title function_">onRejected</span>(that.<span class="hljs-property">reason</span>);<br>                    x <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span> ? x.<span class="hljs-title function_">then</span>(resolve, reject) : <span class="hljs-title function_">resolve</span>(x);<br>                &#125; <span class="hljs-keyword">catch</span>(e) &#123;<br>                    <span class="hljs-title function_">reject</span>(e);<br>                &#125;<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (that.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PENDING</span>) &#123; <span class="hljs-comment">// 等待态</span><br>        <span class="hljs-comment">// 当异步调用resolve/rejected时 将onFulfilled/onRejected收集暂存到集合中</span><br>        <span class="hljs-keyword">return</span> newPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>            that.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">let</span> x = <span class="hljs-title function_">onFulfilled</span>(value);<br>                    x <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span> ? x.<span class="hljs-title function_">then</span>(resolve, reject) : <span class="hljs-title function_">resolve</span>(x);<br>                &#125; <span class="hljs-keyword">catch</span>(e) &#123;<br>                    <span class="hljs-title function_">reject</span>(e);<br>                &#125;<br>            &#125;);<br>            that.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">let</span> x = <span class="hljs-title function_">onRejected</span>(reason);<br>                    x <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span> ? x.<span class="hljs-title function_">then</span>(resolve, reject) : <span class="hljs-title function_">resolve</span>(x);<br>                &#125; <span class="hljs-keyword">catch</span>(e) &#123;<br>                    <span class="hljs-title function_">reject</span>(e);<br>                &#125;<br>            &#125;);<br>        &#125;);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="6-Promise-all"><a href="#6-Promise-all" class="headerlink" title="6.Promise.all"></a>6.Promise.all</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">all</span>=<span class="hljs-keyword">function</span> (<span class="hljs-params">promises</span>) &#123;<br><span class="hljs-comment">// 检查是否是迭代对象</span><br>  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> promises[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] !== <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>      <span class="hljs-keyword">throw</span>(<span class="hljs-string">`传入的参数不是一个可迭代对象`</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(promises))&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">`argument must be a array`</span>)<br>    &#125;<br>    <span class="hljs-keyword">var</span> resolvedCounter = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">var</span> promiseNum = promises.<span class="hljs-property">length</span>;<br>    <span class="hljs-keyword">var</span> resolvedResult = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; promiseNum; i++) &#123;<br>      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(promises[i]).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br>        resolvedCounter++;<br>        resolvedResult[i] = value;<br>        <span class="hljs-keyword">if</span> (resolvedCounter == promiseNum) &#123;<br>            <span class="hljs-title function_">resolve</span>(resolvedResult);<br>          &#125;<br>      &#125;,<span class="hljs-function"><span class="hljs-params">error</span>=&gt;</span>&#123;<br>        <span class="hljs-title function_">reject</span>(error);<br>      &#125;)<br>    &#125;<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="7-Promise-race"><a href="#7-Promise-race" class="headerlink" title="7.Promise.race"></a>7.Promise.race</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">race</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params">proms</span>) &#123;<br><span class="hljs-comment">// 检查是否是迭代对象</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> promises[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] !== <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>    <span class="hljs-keyword">throw</span>(<span class="hljs-string">`传入的参数不是一个可迭代对象`</span>)<br>&#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> p <span class="hljs-keyword">of</span> proms) &#123;<br>      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(p).<span class="hljs-title function_">then</span>(resolve, reject);<br>    &#125;<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="8-Promise-prototype-finally"><a href="#8-Promise-prototype-finally" class="headerlink" title="8.Promise.prototype.finally"></a>8.Promise.prototype.finally</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 无论成功还是失败都会执行回调</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Function</span>&#125; <span class="hljs-variable">onSettled</span></span><br><span class="hljs-comment">   */</span><br> <span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">finally</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">onSettled</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<br>      <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>        <span class="hljs-title function_">onSettled</span>(); <span class="hljs-comment">// 实现了收不到参数了</span><br>        <span class="hljs-keyword">return</span> data;<br>      &#125;,<br>      <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>        <span class="hljs-title function_">onSettled</span>();<br>        <span class="hljs-keyword">throw</span> reason;<br>      &#125;<br>    );<br>    <span class="hljs-comment">// finally函数 返回结果应该是无效的</span><br>  &#125;<br>  <br><span class="hljs-comment">/******test finally*******/</span><br><span class="hljs-comment">// 无论什么结果，都会运行</span><br><span class="hljs-keyword">const</span> pro = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);<br>&#125;);<br><span class="hljs-keyword">const</span> pro2 = pro.<span class="hljs-title function_">finally</span>(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;finally&quot;</span>, d); <span class="hljs-comment">// 收不到d参数</span><br>  <span class="hljs-comment">// 本身不改变状态，但是抛出一个错误，数据就会变成它的错误</span><br>  <span class="hljs-comment">// throw 123;</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-number">123</span>; <span class="hljs-comment">//不起作用</span><br>&#125;);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(pro2);<br>&#125;);<br><br></code></pre></td></tr></table></figure>

<h2 id="9-Promise-allSettled"><a href="#9-Promise-allSettled" class="headerlink" title="9.Promise.allSettled"></a>9.Promise.allSettled</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 等待所有的Promise有结果后</span><br><span class="hljs-comment">   * 该方法返回的Promise完成</span><br><span class="hljs-comment">   * 并且按照顺序将所有结果汇总</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Iterable</span>&#125; <span class="hljs-variable">proms</span></span><br><span class="hljs-comment">   */</span><br>   <br>  <span class="hljs-title class_">Promise</span>.<span class="hljs-property">allSettled</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params">proms</span>) &#123;<br>    <span class="hljs-keyword">const</span> ps = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> p <span class="hljs-keyword">of</span> proms) &#123;<br>      ps.<span class="hljs-title function_">push</span>(<br>        <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(p).<span class="hljs-title function_">then</span>(<br>          <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> (&#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">FULFILLED</span>,<br>            value,<br>          &#125;),<br>          <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> (&#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">REJECTED</span>,<br>            reason,<br>          &#125;)<br>        )<br>      );<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(ps);<br>  &#125;<br></code></pre></td></tr></table></figure>

<h2 id="10-Promise-prototype-catch"><a href="#10-Promise-prototype-catch" class="headerlink" title="10.Promise.prototype.catch"></a>10.Promise.prototype.catch</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 本质就是then，只是少传了一个onFulfilled</span><br><span class="hljs-comment">   * 所以仅处理失败的场景</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; <span class="hljs-variable">onRejected</span></span><br><span class="hljs-comment">   */</span><br><span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">catch</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">onRejected</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">null</span>, onRejected);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="11-Promise-resolve"><a href="#11-Promise-resolve" class="headerlink" title="11.Promise.resolve"></a>11.Promise.resolve</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">resolve</span>=<span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) &#123;<br>  <span class="hljs-comment">// 如果 value 已经是 Promise 对象，则直接返回该 Promise 对象</span><br>  <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span>) &#123;<br>    <span class="hljs-keyword">return</span> value;<br>  &#125;<br>  <span class="hljs-comment">// 如果 value 是 thenable 对象，则包装成 Promise 对象并返回</span><br>  <span class="hljs-keyword">if</span> (value &amp;&amp; <span class="hljs-keyword">typeof</span> value.<span class="hljs-property">then</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>      value.<span class="hljs-title function_">then</span>(resolve, reject);<br>    &#125;);<br>  &#125;<br>  <span class="hljs-comment">// 将传入的值作为 Promise 的成功值，并返回 Promise 对象</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) &#123;<br>    <span class="hljs-title function_">resolve</span>(value);<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="12-Promise-reject"><a href="#12-Promise-reject" class="headerlink" title="12.Promise.reject"></a>12.Promise.reject</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * 得到一个被拒绝的Promise</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; <span class="hljs-variable">reason</span></span><br><span class="hljs-comment">  */</span><br> <span class="hljs-title class_">Promise</span>.<span class="hljs-property">reject</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) &#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>     <span class="hljs-title function_">reject</span>(reason);<br>   &#125;);<br> &#125;<br></code></pre></td></tr></table></figure>

<h2 id="13-防抖和节流"><a href="#13-防抖和节流" class="headerlink" title="13.防抖和节流"></a>13.防抖和节流</h2><p>setTimeout函数中的第一个参数使用箭头函数时，apply中可直接传入this，因为箭头函数的this指向定义时外部代码块的this，如果不是箭头函数，则需要在外层用一个变量保留this再传入。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">callback, time</span>) &#123;<br>    <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (timer) &#123;<br>        <span class="hljs-built_in">clearTimeout</span>(timer)<br>        timer = <span class="hljs-literal">null</span><br>      &#125;<br>      timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        callback.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);<br>      &#125;, time);<br>    &#125;<br>  &#125;<br> <br><span class="hljs-comment">// 第一次执行，中间是节流，最后一次也要执行版本</span><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">throttle</span>(<span class="hljs-params">fn, delay</span>) &#123;<br>  <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;<br>  <span class="hljs-keyword">let</span> lastTime = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> args = <span class="hljs-variable language_">arguments</span>;<br>    <span class="hljs-keyword">const</span> nowTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-keyword">if</span> (nowTime - lastTime &gt;= delay) &#123;<br>      fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);<br>      lastTime = nowTime;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-built_in">clearTimeout</span>(timer);<br>      timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>      fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);<br>      lastTime = nowTime;<br>	&#125;, delay - (nowTime - lastTime));<br>    &#125;<br>  &#125;;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="14-类型判断函数"><a href="#14-类型判断函数" class="headerlink" title="14.类型判断函数"></a>14.类型判断函数</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">function</span> get<span class="hljs-constructor">Type(<span class="hljs-params">value</span>)</span> &#123;<br>	return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>prototype.toString.call(value).slice(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>).<span class="hljs-keyword">to</span><span class="hljs-constructor">LowerCase()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="15-call-apply-bind"><a href="#15-call-apply-bind" class="headerlink" title="15.call apply bind"></a>15.call apply bind</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">Function.prototype.call = <span class="hljs-keyword">function</span><span class="hljs-params">(context, <span class="hljs-rest_arg">...args</span>)</span> &#123;<br>  context = (context === <span class="hljs-literal">undefined</span> || context === <span class="hljs-literal">null</span>) ? window : context<br>  context.__fn = <span class="hljs-keyword">this</span><br>  let result = context.__fn(...args)<br>  <span class="hljs-keyword">delete</span> context.__fn<br>  <span class="hljs-keyword">return</span> result<br>&#125;<br><br>Function.prototype.apply = <span class="hljs-keyword">function</span><span class="hljs-params">(context, args)</span> &#123;<br>  context = (context === <span class="hljs-literal">undefined</span> || context === <span class="hljs-literal">null</span>) ? window : context<br>  context.__fn = <span class="hljs-keyword">this</span><br>  let result = context.__fn(...args)<br>  <span class="hljs-keyword">delete</span> context.__fn<br>  <span class="hljs-keyword">return</span> result<br>&#125;<br><br>Function.prototype.bind = <span class="hljs-keyword">function</span><span class="hljs-params">(context, <span class="hljs-rest_arg">...args1</span>)</span> &#123;<br>  context = (context === <span class="hljs-literal">undefined</span> || context === <span class="hljs-literal">null</span>) ? window : context<br>  let _this = <span class="hljs-keyword">this</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-rest_arg">...args2</span>)</span> &#123;<br>    context.__fn = _this<br>    let result = context.__fn(...[...args1, ...args2])<br>    <span class="hljs-keyword">delete</span> context.__fn<br>    <span class="hljs-keyword">return</span> result<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="16-curry柯里化"><a href="#16-curry柯里化" class="headerlink" title="16.curry柯里化"></a>16.curry柯里化</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myCurrying</span><span class="hljs-params">(fn)</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">curried</span><span class="hljs-params">(<span class="hljs-rest_arg">...args</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (args.length &gt;= fn.length) &#123;<br>      <span class="hljs-keyword">return</span> fn.apply(<span class="hljs-keyword">this</span>, args);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-rest_arg">...args2</span>)</span> &#123;<br>        <span class="hljs-keyword">return</span> curried.apply(<span class="hljs-keyword">this</span>, args.concat(args2));<br>      &#125;;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="17-AJAX请求"><a href="#17-AJAX请求" class="headerlink" title="17.AJAX请求"></a>17.AJAX请求</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">const</span> SERVER_URL = <span class="hljs-string">&quot;/server&quot;</span>;<br>let xhr = new XMLHttpRequest();<br><span class="hljs-comment">// 创建 Http 请求</span><br>xhr.<span class="hljs-keyword">open</span>(<span class="hljs-string">&quot;GET&quot;</span>, SERVER_URL, <span class="hljs-literal">true</span>);<br><span class="hljs-comment">// 设置状态监听函数</span><br>xhr.onreadystatechange = function() &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.readyState !== <span class="hljs-number">4</span>) <span class="hljs-keyword">return</span>;<br>  <span class="hljs-comment">// 当请求成功时</span><br>  <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">this</span>.status &gt;= <span class="hljs-number">200</span>&amp;&amp;<span class="hljs-keyword">this</span>.status&lt;<span class="hljs-number">300</span>)|| <span class="hljs-keyword">this</span>.status === <span class="hljs-number">304</span>) &#123;<br>    handle(<span class="hljs-keyword">this</span>.response);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    console.error(<span class="hljs-keyword">this</span>.statusText);<br>  &#125;<br>&#125;;<br><span class="hljs-comment">// 设置请求失败时的监听函数</span><br>xhr.onerror = function() &#123;<br>  console.error(<span class="hljs-keyword">this</span>.statusText);<br>&#125;;<br><span class="hljs-comment">// 设置请求头信息</span><br>xhr.responseType = <span class="hljs-string">&quot;json&quot;</span>;<br>xhr.setRequestHeader(<span class="hljs-string">&quot;Accept&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);<br><span class="hljs-comment">// 发送 Http 请求</span><br>xhr.send(<span class="hljs-literal">null</span>);<br><br></code></pre></td></tr></table></figure>

<h2 id="18-Promise封装AJAX请求"><a href="#18-Promise封装AJAX请求" class="headerlink" title="18.Promise封装AJAX请求"></a>18.Promise封装AJAX请求</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getJSON</span>(<span class="hljs-params">url</span>) &#123;<br>  <span class="hljs-comment">// 创建一个 promise 对象</span><br>  <span class="hljs-keyword">let</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-keyword">let</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    <span class="hljs-comment">// 新建一个 http 请求</span><br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>, url, <span class="hljs-literal">true</span>);<br>    <span class="hljs-comment">// 设置状态的监听函数</span><br>    xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">readyState</span> !== <span class="hljs-number">4</span>) <span class="hljs-keyword">return</span>;<br>      <span class="hljs-comment">// 当请求成功或失败时，改变 promise 的状态</span><br>      <span class="hljs-keyword">if</span> ((<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span>&amp;&amp;<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span>&lt;<span class="hljs-number">300</span>)|| <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-number">304</span>) &#123;<br>        <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">response</span>);<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">statusText</span>));<br>      &#125;<br>    &#125;;<br>    <span class="hljs-comment">// 设置错误监听函数</span><br>    xhr.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">statusText</span>));<br>    &#125;;<br>    <span class="hljs-comment">// 设置响应的数据类型</span><br>    xhr.<span class="hljs-property">responseType</span> = <span class="hljs-string">&quot;json&quot;</span>;<br>    <span class="hljs-comment">// 设置请求头信息</span><br>    xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&quot;Accept&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);<br>    <span class="hljs-comment">// 发送 http 请求</span><br>    xhr.<span class="hljs-title function_">send</span>(<span class="hljs-literal">null</span>);<br>  &#125;);<br>  <span class="hljs-keyword">return</span> promise;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="19-实现浅拷贝"><a href="#19-实现浅拷贝" class="headerlink" title="19.实现浅拷贝"></a>19.实现浅拷贝</h2><p>浅拷贝是指，一个新的对象对原始对象的属性值进行精确地拷贝，如果拷贝的是基本数据类型，拷贝的就是基本数据类型的值，如果是引用数据类型，拷贝的就是内存地址。如果其中一个对象的引用内存地址发生改变，另一个对象也会发生变化。</p>
<h3 id="（1）Object-assign"><a href="#（1）Object-assign" class="headerlink" title="（1）Object.assign()"></a>（1）Object.assign()</h3><p><code>Object.assign()</code>是ES6中对象的拷贝方法，接受的第一个参数是目标对象，其余参数是源对象，用法：<code>Object.assign(target, source_1, ···)</code>，该方法可以实现浅拷贝，也可以实现一维对象的深拷贝。</p>
<p><strong>注意：</strong></p>
<ul>
<li>如果目标对象和源对象有同名属性，或者多个源对象有同名属性，则后面的属性会覆盖前面的属性。</li>
<li>如果该函数只有一个参数，当参数为对象时，直接返回该对象；当参数不是对象时，会先将参数转为对象然后返回。</li>
<li>因为<code>null</code> 和 <code>undefined</code> 不能转化为对象，所以第一个参数不能为<code>null</code>或 <code>undefined</code>，会报错。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> target = &#123;<span class="hljs-attr">a</span>: <span class="hljs-number">1</span>&#125;;<br><span class="hljs-keyword">let</span> object2 = &#123;<span class="hljs-attr">b</span>: <span class="hljs-number">2</span>&#125;;<br><span class="hljs-keyword">let</span> object3 = &#123;<span class="hljs-attr">c</span>: <span class="hljs-number">3</span>&#125;;<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(target,object2,object3);  <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(target);  <span class="hljs-comment">// &#123;a: 1, b: 2, c: 3&#125;</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（2）扩展运算符"><a href="#（2）扩展运算符" class="headerlink" title="（2）扩展运算符"></a>（2）扩展运算符</h3><p>使用扩展运算符可以在构造字面量对象的时候，进行属性的拷贝。语法：<code>let cloneObj = &#123; ...obj &#125;;</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj1 = &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">b</span>:&#123;<span class="hljs-attr">c</span>:<span class="hljs-number">1</span>&#125;&#125;<br><span class="hljs-keyword">let</span> obj2 = &#123;...obj1&#125;;<br>obj1.<span class="hljs-property">a</span> = <span class="hljs-number">2</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1); <span class="hljs-comment">//&#123;a:2,b:&#123;c:1&#125;&#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj2); <span class="hljs-comment">//&#123;a:1,b:&#123;c:1&#125;&#125;</span><br>obj1.<span class="hljs-property">b</span>.<span class="hljs-property">c</span> = <span class="hljs-number">2</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1); <span class="hljs-comment">//&#123;a:2,b:&#123;c:2&#125;&#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj2); <span class="hljs-comment">//&#123;a:1,b:&#123;c:2&#125;&#125;</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（3）数组方法实现数组浅拷贝"><a href="#（3）数组方法实现数组浅拷贝" class="headerlink" title="（3）数组方法实现数组浅拷贝"></a>（3）数组方法实现数组浅拷贝</h3><h6 id="1）Array-prototype-slice"><a href="#1）Array-prototype-slice" class="headerlink" title="1）Array.prototype.slice"></a><strong>1）Array.prototype.slice</strong></h6><ul>
<li><code>slice()</code>方法是JavaScript数组的一个方法，这个方法可以从已有数组中返回选定的元素：用法：<code>array.slice(start, end)</code>，该方法不会改变原始数组。</li>
<li>该方法有两个参数，两个参数都可选，如果两个参数都不写，就可以实现一个数组的浅拷贝。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">slice</span>()); <span class="hljs-comment">// [1,2,3,4]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">slice</span>() === arr); <span class="hljs-comment">//false</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h6 id="2）Array-prototype-concat"><a href="#2）Array-prototype-concat" class="headerlink" title="2）Array.prototype.concat"></a><strong>2）Array.prototype.concat</strong></h6><ul>
<li><code>concat()</code> 方法用于合并两个或多个数组。此方法不会更改现有数组，而是返回一个新数组。</li>
<li>该方法有两个参数，两个参数都可选，如果两个参数都不写，就可以实现一个数组的浅拷贝。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">concat</span>()); <span class="hljs-comment">// [1,2,3,4]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">concat</span>() === arr); <span class="hljs-comment">//false</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（4）手写实现浅拷贝"><a href="#（4）手写实现浅拷贝" class="headerlink" title="（4）手写实现浅拷贝"></a>（4）手写实现浅拷贝</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 浅拷贝的实现;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">shallowCopy</span>(<span class="hljs-params">object</span>) &#123;<br>  <span class="hljs-comment">// 只拷贝对象</span><br>  <span class="hljs-keyword">if</span> (!object || <span class="hljs-keyword">typeof</span> object !== <span class="hljs-string">&quot;object&quot;</span>) <span class="hljs-keyword">return</span>;<br><br>  <span class="hljs-comment">// 根据 object 的类型判断是新建一个数组还是对象</span><br>  <span class="hljs-keyword">let</span> newObject = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(object) ? [] : &#123;&#125;;<br><br>  <span class="hljs-comment">// 遍历 object，并且判断是 object 的属性才拷贝</span><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> object) &#123;<br>    <span class="hljs-keyword">if</span> (object.<span class="hljs-title function_">hasOwnProperty</span>(key)) &#123;<br>      newObject[key] = object[key];<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> newObject;<br>&#125;<span class="hljs-comment">// 浅拷贝的实现;</span><br></code></pre></td></tr></table></figure>

<h2 id="20-实现深拷贝"><a href="#20-实现深拷贝" class="headerlink" title="20. 实现深拷贝"></a>20. 实现深拷贝</h2><ul>
<li><strong>浅拷贝：</strong> 浅拷贝指的是将一个对象的属性值复制到另一个对象，如果有的属性的值为引用类型的话，那么会将这个引用的地址复制给对象，因此两个对象会有同一个引用类型的引用。浅拷贝可以使用  Object.assign 和展开运算符来实现。</li>
<li><strong>深拷贝：</strong> 深拷贝相对浅拷贝而言，如果遇到属性值为引用类型的时候，它新建一个引用类型并将对应的值复制给它，因此对象获得的一个新的引用类型而不是一个原有类型的引用。深拷贝对于一些对象可以使用 JSON 的两个函数来实现，但是由于 JSON 的对象格式比 js 的对象格式更加严格，所以如果属性值里边出现函数或者 Symbol 类型的值时，会转换失败</li>
</ul>
<h3 id="（1）JSON-stringify"><a href="#（1）JSON-stringify" class="headerlink" title="（1）JSON.stringify()"></a>（1）JSON.stringify()</h3><ul>
<li><code>JSON.parse(JSON.stringify(obj))</code>是目前比较常用的深拷贝方法之一，它的原理就是利用<code>JSON.stringify</code> 将<code>js</code>对象序列化（JSON字符串），再使用<code>JSON.parse</code>来反序列化(还原)<code>js</code>对象。</li>
<li>这个方法可以简单粗暴的实现深拷贝，但是还存在问题，拷贝的对象中如果有函数，undefined，symbol，当使用过<code>JSON.stringify()</code>进行处理之后，都会消失。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj1 = &#123;  <span class="hljs-attr">a</span>: <span class="hljs-number">0</span>,<br>              <span class="hljs-attr">b</span>: &#123;<br>                 <span class="hljs-attr">c</span>: <span class="hljs-number">0</span><br>                 &#125;<br>            &#125;;<br><span class="hljs-keyword">let</span> obj2 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj1));<br>obj1.<span class="hljs-property">a</span> = <span class="hljs-number">1</span>;<br>obj1.<span class="hljs-property">b</span>.<span class="hljs-property">c</span> = <span class="hljs-number">1</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1); <span class="hljs-comment">// &#123;a: 1, b: &#123;c: 1&#125;&#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj2); <span class="hljs-comment">// &#123;a: 0, b: &#123;c: 0&#125;&#125;</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（2）函数库lodash的-cloneDeep方法"><a href="#（2）函数库lodash的-cloneDeep方法" class="headerlink" title="（2）函数库lodash的_.cloneDeep方法"></a>（2）函数库lodash的_.cloneDeep方法</h3><p>该函数库也有提供_.cloneDeep用来做 Deep Copy</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;lodash&#x27;</span>);<br><span class="hljs-keyword">var</span> obj1 = &#123;<br>    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">b</span>: &#123; <span class="hljs-attr">f</span>: &#123; <span class="hljs-attr">g</span>: <span class="hljs-number">1</span> &#125; &#125;,<br>    <span class="hljs-attr">c</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br>&#125;;<br><span class="hljs-keyword">var</span> obj2 = _.<span class="hljs-title function_">cloneDeep</span>(obj1);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1.<span class="hljs-property">b</span>.<span class="hljs-property">f</span> === obj2.<span class="hljs-property">b</span>.<span class="hljs-property">f</span>);<span class="hljs-comment">// false</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（3）手写实现深拷贝函数"><a href="#（3）手写实现深拷贝函数" class="headerlink" title="（3）手写实现深拷贝函数"></a>（3）手写实现深拷贝函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 深拷贝的实现</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepCopy</span>(<span class="hljs-params">object</span>) &#123;<br>  <span class="hljs-keyword">if</span> (!object || <span class="hljs-keyword">typeof</span> object !== <span class="hljs-string">&quot;object&quot;</span>) <span class="hljs-keyword">return</span>;<br><br>  <span class="hljs-keyword">let</span> newObject = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(object) ? [] : &#123;&#125;;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> object) &#123;<br>    <span class="hljs-keyword">if</span> (object.<span class="hljs-title function_">hasOwnProperty</span>(key)) &#123;<br>      newObject[key] =<br>        <span class="hljs-keyword">typeof</span> object[key] === <span class="hljs-string">&quot;object&quot;</span> ? <span class="hljs-title function_">deepCopy</span>(object[key]) : object[key];<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> newObject;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="21-日期格式化函数"><a href="#21-日期格式化函数" class="headerlink" title="21.日期格式化函数"></a>21.日期格式化函数</h2><p>最简易版本的，注意 没有加0的版本<br>格式：年-月-日 时:分:秒</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">formatTime</span>(<span class="hljs-params"></span>) &#123;<br>  const time = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<br>  const <span class="hljs-built_in">year</span> = time.getFullYear();<br>  const <span class="hljs-built_in">month</span> = time.getMonth() + <span class="hljs-number">1</span>;<br>  const <span class="hljs-built_in">day</span> = time.getDate();<br>  const <span class="hljs-built_in">hour</span> = time.getHours();<br>  const <span class="hljs-built_in">minute</span> = time.getMinutes();<br>  const seconds = time.getSeconds();<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-built_in">year</span>&#125;</span>-<span class="hljs-subst">$&#123;<span class="hljs-built_in">month</span>&#125;</span>-<span class="hljs-subst">$&#123;<span class="hljs-built_in">day</span>&#125;</span> <span class="hljs-subst">$&#123;<span class="hljs-built_in">hour</span>&#125;</span>:<span class="hljs-subst">$&#123;<span class="hljs-built_in">minute</span>&#125;</span>:<span class="hljs-subst">$&#123;seconds&#125;</span>`</span>;<br>&#125;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(formatTime());<br></code></pre></td></tr></table></figure>

<h2 id="22-数组的乱序输出"><a href="#22-数组的乱序输出" class="headerlink" title="22.数组的乱序输出"></a>22.数组的乱序输出</h2><p>主要的实现思路就是：</p>
<ul>
<li>取出数组的第一个元素，随机产生一个索引值，将该第一个元素和这个索引对应的元素进行交换。</li>
<li>第二次取出数据数组第二个元素，随机产生一个除了索引为1的之外的索引值，并将第二个元素与该索引值对应的元素进行交换</li>
<li>按照上面的规律执行，直到遍历完成</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>  <span class="hljs-keyword">const</span> randomIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (arr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> - i)) + i;<br>  [arr[i], arr[randomIndex]] = [arr[randomIndex], arr[i]];<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr)<br></code></pre></td></tr></table></figure>

<h2 id="23-数组的扁平化"><a href="#23-数组的扁平化" class="headerlink" title="23.数组的扁平化"></a>23.数组的扁平化</h2><h3 id="（1）递归实现"><a href="#（1）递归实现" class="headerlink" title="（1）递归实现"></a><strong>（1）递归实现</strong></h3><p>普通的递归思路很容易理解，就是通过循环递归的方式，一项一项地去遍历，如果每一项还是一个数组，那么就继续往下遍历，利用递归程序的方法，来实现数组的每一项的连接：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]]];<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">let</span> result = [];<br><br>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr[i])) &#123;<br>      result = result.<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">flatten</span>(arr[i]));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      result.<span class="hljs-title function_">push</span>(arr[i]);<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-title function_">flatten</span>(arr);  <span class="hljs-comment">//  [1, 2, 3, 4，5]</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（2）reduce-函数迭代"><a href="#（2）reduce-函数迭代" class="headerlink" title="（2）reduce 函数迭代"></a>（2）reduce 函数迭代</h3><p>从上面普通的递归函数中可以看出，其实就是对数组的每一项进行处理，那么其实也可以用reduce 来实现数组的拼接，从而简化第一种方法的代码，改造后的代码如下所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]];<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">reduce</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">prev, next</span>)&#123;<br>        <span class="hljs-keyword">return</span> prev.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(next) ? <span class="hljs-title function_">flatten</span>(next) : next)<br>    &#125;, [])<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">flatten</span>(arr));<span class="hljs-comment">//  [1, 2, 3, 4，5]</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（3）扩展运算符实现"><a href="#（3）扩展运算符实现" class="headerlink" title="（3）扩展运算符实现"></a><strong>（3）扩展运算符实现</strong></h3><p>这个方法的实现，采用了扩展运算符和 some 的方法，两者共同使用，达到数组扁平化的目的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]];<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">while</span> (arr.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(item))) &#123;<br>        arr = [].<span class="hljs-title function_">concat</span>(...arr);<br>    &#125;<br>    <span class="hljs-keyword">return</span> arr;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">flatten</span>(arr)); <span class="hljs-comment">//  [1, 2, 3, 4，5]</span><br>复制代码<br></code></pre></td></tr></table></figure>

<h3 id="（4）split-和-toString"><a href="#（4）split-和-toString" class="headerlink" title="（4）split 和 toString"></a><strong>（4）split 和 toString</strong></h3><p>可以通过 split 和 toString 两个方法来共同实现数组扁平化，由于数组会默认带一个 toString 的方法，所以可以把数组直接转换成逗号分隔的字符串，然后再用 split 方法把字符串重新转换为数组，如下面的代码所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]];<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">flatten</span>(arr)); <span class="hljs-comment">//  [1, 2, 3, 4，5]</span><br>复制代码<br></code></pre></td></tr></table></figure>

<p>通过这两个方法可以将多维数组直接转换成逗号连接的字符串，然后再重新分隔成数组。</p>
<h3 id="（5）ES6-中的-flat"><a href="#（5）ES6-中的-flat" class="headerlink" title="（5）ES6 中的 flat"></a><strong>（5）ES6 中的 flat</strong></h3><p>我们还可以直接调用 ES6 中的 flat 方法来实现数组扁平化。flat 方法的语法：<code>arr.flat([depth])</code></p>
<p>其中 depth 是 flat 的参数，depth 是可以传递数组的展开深度（默认不填、数值是 1），即展开一层数组。如果层数不确定，参数可以传进 Infinity，代表不论多少层都要展开：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]];<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">flat</span>(<span class="hljs-title class_">Infinity</span>);<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">flatten</span>(arr)); <span class="hljs-comment">//  [1, 2, 3, 4，5]</span><br>复制代码<br></code></pre></td></tr></table></figure>

<p>可以看出，一个嵌套了两层的数组，通过将 flat 方法的参数设置为 Infinity，达到了我们预期的效果。其实同样也可以设置成 2，也能实现这样的效果。在编程过程中，如果数组的嵌套层数不确定，最好直接使用 Infinity，可以达到扁平化。 <strong>（6）正则和 JSON 方法</strong> 在第4种方法中已经使用 toString 方法，其中仍然采用了将 JSON.stringify 的方法先转换为字符串，然后通过正则表达式过滤掉字符串中的数组的方括号，最后再利用 JSON.parse 把它转换成数组：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>]]], <span class="hljs-number">6</span>];<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">let</span> str = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(arr);<br>  str = str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/(\[|\])/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>  str = <span class="hljs-string">&#x27;[&#x27;</span> + str + <span class="hljs-string">&#x27;]&#x27;</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(str); <br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">flatten</span>(arr)); <span class="hljs-comment">//  [1, 2, 3, 4，5]</span><br></code></pre></td></tr></table></figure>



<h2 id="24-数组去重"><a href="#24-数组去重" class="headerlink" title="24.数组去重"></a>24.数组去重</h2><p>给定某无序数组，要求去除数组中的重复数字并且返回新的无重复数组。</p>
<p>ES6方法（使用数据结构集合）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> array = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>];<br><br><span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(array)); <span class="hljs-comment">// [1, 2, 3, 5, 9, 8]</span><br>复制代码<br></code></pre></td></tr></table></figure>

<p>ES5方法：使用map存储不重复的数字（可以使用reduce代替for循环）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> array = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>];<br><br><span class="hljs-title function_">uniqueArray</span>(array); <span class="hljs-comment">// [1, 2, 3, 5, 9, 8]</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueArray</span>(<span class="hljs-params">array</span>) &#123;<br>  <span class="hljs-keyword">let</span> map = &#123;&#125;;<br>  <span class="hljs-keyword">let</span> res = [];<br>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; array.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span>(!map.<span class="hljs-title function_">hasOwnProperty</span>([array[i]])) &#123;<br>      map[array[i]] = <span class="hljs-number">1</span>;<br>      res.<span class="hljs-title function_">push</span>(array[i]);<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-comment">// 方法三 ： filter+indexOf</span><br>const <span class="hljs-keyword">new</span><span class="hljs-type">Arr2</span> = [];<br>arr.filter((item, index) =&gt;&#123;<br><span class="hljs-keyword">if</span>(arr.indexOf(item) === index) &#123;<br><span class="hljs-keyword">new</span><span class="hljs-type">Arr2</span>.push(item)<br>&#125;<br>&#125;)<br>console.log(<span class="hljs-keyword">new</span><span class="hljs-type">Arr2</span>);<br><br><br><span class="hljs-comment">// 方法四 ： includes</span><br>let <span class="hljs-keyword">new</span><span class="hljs-type">Arr3</span> = [];<br><span class="hljs-keyword">for</span> (let i = <span class="hljs-number">0</span>; i&lt;arr.length; i++) &#123;<br><span class="hljs-keyword">if</span>( !<span class="hljs-keyword">new</span><span class="hljs-type">Arr3</span>.includes(arr[i]) ) &#123;<br><span class="hljs-keyword">new</span><span class="hljs-type">Arr3</span>.push(arr[i]);<br>&#125;<br>&#125;<br>console.log(<span class="hljs-keyword">new</span><span class="hljs-type">Arr3</span>);<br></code></pre></td></tr></table></figure>

<h2 id="25-Array-prototype-flat"><a href="#25-Array-prototype-flat" class="headerlink" title="25.Array.prototype.flat"></a>25.Array.prototype.flat</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">flat</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">deep = <span class="hljs-number">1</span></span>) &#123;<br>    <span class="hljs-keyword">let</span> res = []<br>    deep--<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> p <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(p) &amp;&amp; deep &gt;= <span class="hljs-number">0</span>) &#123;<br>            res = res.<span class="hljs-title function_">concat</span>(p.<span class="hljs-title function_">flat</span>(deep))<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            res.<span class="hljs-title function_">push</span>(p)<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="26-Array-prototype-push"><a href="#26-Array-prototype-push" class="headerlink" title="26.Array.prototype.push"></a>26.Array.prototype.push</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">Array.prototype.myPush = <span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-rest_arg">...arg</span>)</span> &#123;<br>  <span class="hljs-keyword">for</span> (let i = <span class="hljs-number">0</span>; i &lt; arg.length; i++) &#123;<br>    <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.length] = arg[i];<br>  &#125;        <br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.length;<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="27-Array-prototype-filter"><a href="#27-Array-prototype-filter" class="headerlink" title="27.Array.prototype.filter"></a>27.Array.prototype.filter</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myFilter</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) &#123;<br>  <span class="hljs-keyword">const</span> res = [];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-title function_">callback</span>(<span class="hljs-variable language_">this</span>[i], i, <span class="hljs-variable language_">this</span>) &amp;&amp; res.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>[i]);<br>  &#125;<br>  <span class="hljs-keyword">return</span> res;<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="28-Array-prototype-map"><a href="#28-Array-prototype-map" class="headerlink" title="28.Array.prototype.map"></a>28.Array.prototype.map</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">map</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) &#123;<br>    <span class="hljs-keyword">const</span> res = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>; i++) &#123;<br>        res.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">callback</span>(<span class="hljs-variable language_">this</span>[i], i, <span class="hljs-variable language_">this</span>))<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="29-String-prototype-repeat"><a href="#29-String-prototype-repeat" class="headerlink" title="29.String.prototype.repeat"></a>29.String.prototype.repeat</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> <span class="hljs-title class_">String</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">repeat</span>= <span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">let</span> str = <span class="hljs-variable language_">this</span>;<br>    <span class="hljs-keyword">let</span> res = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">while</span> (n) &#123;<br>        res += str;<br>        n--<br>    &#125;<br>    <span class="hljs-keyword">return</span> res<br>&#125;<br><span class="hljs-comment">//补充</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">repeat</span>(<span class="hljs-params">s, n</span>) &#123;<br>    <span class="hljs-keyword">return</span> (n &gt; <span class="hljs-number">0</span>) ? s.<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">repeat</span>(s, --n)) : <span class="hljs-string">&quot;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="30-类数组转化为数组"><a href="#30-类数组转化为数组" class="headerlink" title="30.类数组转化为数组"></a>30.类数组转化为数组</h2><ul>
<li>通过 call 调用数组的 slice 方法来实现转换</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(arrayLike);<br></code></pre></td></tr></table></figure>

<ul>
<li>通过 call 调用数组的 splice 方法来实现转换</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">splice</span>.<span class="hljs-title function_">call</span>(arrayLike, <span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure>

<ul>
<li>通过 apply 调用数组的 concat 方法来实现转换</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">concat</span>.<span class="hljs-title function_">apply</span>([], arrayLike);<br></code></pre></td></tr></table></figure>

<ul>
<li>通过 Array.from 方法来实现转换</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(arrayLike);<br></code></pre></td></tr></table></figure>

<h2 id="31-解析-URL-Params-为对象"><a href="#31-解析-URL-Params-为对象" class="headerlink" title="31.解析 URL Params 为对象"></a>31.解析 URL Params 为对象</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">function</span> parseParam(url) &#123;<br>  const paramsStr = <span class="hljs-regexp">/.+\?(.+)$/</span>.exec(url)[<span class="hljs-number">1</span>]; <span class="hljs-regexp">//</span> 将 ? 后面的字符串取出来<br>  const paramsArr = paramsStr.split(<span class="hljs-string">&#x27;&amp;&#x27;</span>); <span class="hljs-regexp">//</span> 将字符串以 &amp; 分割后存到数组中<br>  let paramsObj = &#123;&#125;;<br>  <span class="hljs-regexp">//</span> 将 params 存到对象中<br>  paramsArr.forEach(param =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/=/</span>.test(param)) &#123; <span class="hljs-regexp">//</span> 处理有 value 的参数<br>      let [key, val] = param.split(<span class="hljs-string">&#x27;=&#x27;</span>); <span class="hljs-regexp">//</span> 分割 key 和 value<br>      val = decodeURIComponent(val); <span class="hljs-regexp">//</span> 解码<br>      <span class="hljs-keyword">if</span> (paramsObj.hasOwnProperty(key)) &#123; <span class="hljs-regexp">//</span> 如果对象有 key，则添加一个值<br>        paramsObj[key] = [].concat(paramsObj[key], val);<br>      &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-regexp">//</span> 如果对象没有这个 key，创建 key 并设置值<br>        paramsObj[key] = val;<br>      &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-regexp">//</span> 处理没有 value 的参数<br>      paramsObj[param] = true;<br>    &#125;<br>  &#125;)<br>  return paramsObj;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="32-循环打印红黄绿"><a href="#32-循环打印红黄绿" class="headerlink" title="32.循环打印红黄绿"></a>32.循环打印红黄绿</h2><p>下面来看一道比较典型的问题，通过这个问题来对比几种异步编程方法：<strong>红灯 3s 亮一次，绿灯 1s 亮一次，黄灯 2s 亮一次；如何让三个灯不断交替重复亮灯？</strong></p>
<p>三个亮灯函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">red</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;red&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">green</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;green&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">yellow</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;yellow&#x27;</span>);<br>&#125;<br>复制代码<br></code></pre></td></tr></table></figure>

<p>这道题复杂的地方在于<strong>需要“交替重复”亮灯</strong>，而不是“亮完一次”就结束了。</p>
<h3 id="（1）用-callback-实现"><a href="#（1）用-callback-实现" class="headerlink" title="（1）用 callback 实现"></a>（1）用 callback 实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">task</span> = (<span class="hljs-params">timer, light, callback</span>) =&gt; &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (light === <span class="hljs-string">&#x27;red&#x27;</span>) &#123;<br>            <span class="hljs-title function_">red</span>()<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (light === <span class="hljs-string">&#x27;green&#x27;</span>) &#123;<br>            <span class="hljs-title function_">green</span>()<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (light === <span class="hljs-string">&#x27;yellow&#x27;</span>) &#123;<br>            <span class="hljs-title function_">yellow</span>()<br>        &#125;<br>        <span class="hljs-title function_">callback</span>()<br>    &#125;, timer)<br>&#125;<br><span class="hljs-title function_">task</span>(<span class="hljs-number">3000</span>, <span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title function_">task</span>(<span class="hljs-number">2000</span>, <span class="hljs-string">&#x27;green&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">task</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">&#x27;yellow&#x27;</span>, <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)<br>    &#125;)<br>&#125;)<br>复制代码<br></code></pre></td></tr></table></figure>

<p>这里存在一个 bug：代码只是完成了一次流程，执行后红黄绿灯分别只亮一次。该如何让它交替重复进行呢？</p>
<p>上面提到过递归，可以递归亮灯的一个周期：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">step</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-title function_">task</span>(<span class="hljs-number">3000</span>, <span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">task</span>(<span class="hljs-number">2000</span>, <span class="hljs-string">&#x27;green&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-title function_">task</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">&#x27;yellow&#x27;</span>, step)<br>        &#125;)<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">step</span>()<br>复制代码<br></code></pre></td></tr></table></figure>

<p><strong>注意看黄灯亮的回调里又再次调用了 step 方法</strong> 以完成循环亮灯。</p>
<h3 id="（2）用-promise-实现"><a href="#（2）用-promise-实现" class="headerlink" title="（2）用 promise 实现"></a>（2）用 promise 实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">task</span> = (<span class="hljs-params">timer, light</span>) =&gt; <br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-keyword">if</span> (light === <span class="hljs-string">&#x27;red&#x27;</span>) &#123;<br>                <span class="hljs-title function_">red</span>()<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (light === <span class="hljs-string">&#x27;green&#x27;</span>) &#123;<br>                <span class="hljs-title function_">green</span>()<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (light === <span class="hljs-string">&#x27;yellow&#x27;</span>) &#123;<br>                <span class="hljs-title function_">yellow</span>()<br>            &#125;<br>            <span class="hljs-title function_">resolve</span>()<br>        &#125;, timer)<br>    &#125;)<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">step</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-title function_">task</span>(<span class="hljs-number">3000</span>, <span class="hljs-string">&#x27;red&#x27;</span>)<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">task</span>(<span class="hljs-number">2000</span>, <span class="hljs-string">&#x27;green&#x27;</span>))<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">task</span>(<span class="hljs-number">2100</span>, <span class="hljs-string">&#x27;yellow&#x27;</span>))<br>        .<span class="hljs-title function_">then</span>(step)<br>&#125;<br><span class="hljs-title function_">step</span>()<br>复制代码<br></code></pre></td></tr></table></figure>

<p>这里将回调移除，在一次亮灯结束后，resolve 当前 promise，并依然使用递归进行。</p>
<h3 id="（3）用-async-x2F-await-实现"><a href="#（3）用-async-x2F-await-实现" class="headerlink" title="（3）用 async&#x2F;await 实现"></a>（3）用 async&#x2F;await 实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">taskRunner</span> =  <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">task</span>(<span class="hljs-number">3000</span>, <span class="hljs-string">&#x27;red&#x27;</span>)<br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">task</span>(<span class="hljs-number">2000</span>, <span class="hljs-string">&#x27;green&#x27;</span>)<br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">task</span>(<span class="hljs-number">2100</span>, <span class="hljs-string">&#x27;yellow&#x27;</span>)<br>    <span class="hljs-title function_">taskRunner</span>()<br>&#125;<br><span class="hljs-title function_">taskRunner</span>()<br></code></pre></td></tr></table></figure>

<h2 id="33-每隔一秒打印-1-2-3-4"><a href="#33-每隔一秒打印-1-2-3-4" class="headerlink" title="33.每隔一秒打印 1,2,3,4"></a>33.每隔一秒打印 1,2,3,4</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 使用闭包实现</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>  (<span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i);<br>    &#125;, i * <span class="hljs-number">1000</span>);<br>  &#125;)(i);<br>&#125;<br><span class="hljs-comment">// 使用 let 块级作用域</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i);<br>  &#125;, i * <span class="hljs-number">1000</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="34-Promise实现图片的异步加载"><a href="#34-Promise实现图片的异步加载" class="headerlink" title="34.Promise实现图片的异步加载"></a>34.Promise实现图片的异步加载</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-title function_">imageAsync</span>=(<span class="hljs-params">url</span>)=&gt;&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>                <span class="hljs-keyword">let</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();<span class="hljs-comment">//img变量是一个img标签</span><br>                img.<span class="hljs-property">src</span> = url;<br>                img.οnlοad=<span class="hljs-function">()=&gt;</span>&#123;<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`图片请求成功，此处进行通用操作`</span>);<br>                    <span class="hljs-title function_">resolve</span>(image);<br>                &#125;<br>                img.οnerrοr=<span class="hljs-function">(<span class="hljs-params">err</span>)=&gt;</span>&#123;<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`失败，此处进行失败的通用操作`</span>);<br>                    <span class="hljs-title function_">reject</span>(err);<br>                &#125;<br>            &#125;)<br>        &#125;<br>        <br><span class="hljs-title function_">imageAsync</span>(<span class="hljs-string">&quot;url&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;加载成功&quot;</span>);<br>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>)=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;加载失败&quot;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure>

<h2 id="35-发布-订阅模式"><a href="#35-发布-订阅模式" class="headerlink" title="35.发布-订阅模式"></a>35.发布-订阅模式</h2><p>题目描述:实现一个发布订阅模式拥有 on emit once off 方法</p>
<p>实现代码如下:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span> = &#123;&#125;;<br>  &#125;<br>  <span class="hljs-comment">// 实现订阅</span><br>  <span class="hljs-title function_">on</span>(<span class="hljs-params">type, callBack</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type]) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type] = [callBack];<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type].<span class="hljs-title function_">push</span>(callBack);<br>    &#125;<br>  &#125;<br>  <span class="hljs-comment">// 删除订阅</span><br>  <span class="hljs-title function_">off</span>(<span class="hljs-params">type, callBack</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type]) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type].<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> item !== callBack;<br>    &#125;);<br>  &#125;<br>  <span class="hljs-comment">// 只执行一次订阅事件</span><br>  <span class="hljs-title function_">once</span>(<span class="hljs-params">type, callBack</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-title function_">callBack</span>();<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(type, fn);<br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(type, fn);<br>  &#125;<br>  <span class="hljs-comment">// 触发事件</span><br>  <span class="hljs-title function_">emit</span>(<span class="hljs-params">type, ...rest</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type] &amp;&amp;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[type].<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, rest));<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="36-封装异步的fetch，使用async-await方式来使用"><a href="#36-封装异步的fetch，使用async-await方式来使用" class="headerlink" title="36.封装异步的fetch，使用async await方式来使用"></a>36.封装异步的fetch，使用async await方式来使用</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myFetchAsync</span>(<span class="hljs-params">url, options</span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">//等 获取到数据</span><br>    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url, options);<br>    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;response.status&#125;</span> <span class="hljs-subst">$&#123;response.statusText&#125;</span>`</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> response;<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>    <span class="hljs-keyword">throw</span> error;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="37-实现简单路由"><a href="#37-实现简单路由" class="headerlink" title="37.实现简单路由"></a>37.实现简单路由</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">function Router()&#123;<br>            <span class="hljs-keyword">this</span>.routes=&#123;&#125;<br>            <span class="hljs-keyword">this</span>.curUrl=<span class="hljs-string">&#x27;&#x27;</span><br> <br>            <span class="hljs-comment">//添加回调函数</span><br>            <span class="hljs-keyword">this</span>.route=function(path,callback)&#123;<br>                <span class="hljs-keyword">this</span>.routes[path]=callback||function()&#123;&#125;<br>            &#125;<br>            <span class="hljs-comment">//执行回调函数</span><br>            <span class="hljs-keyword">this</span>.refresh=function()&#123;<br>                <span class="hljs-comment">//获取url</span><br>                <span class="hljs-keyword">this</span>.curUrl=location.hash.slice(<span class="hljs-number">1</span>)||<span class="hljs-string">&#x27;/&#x27;</span><br>                <span class="hljs-keyword">this</span>.routes[<span class="hljs-keyword">this</span>.curUrl]()<br>            &#125;<br>            <span class="hljs-comment">//监听load和hashchange</span><br>            <span class="hljs-keyword">this</span>.<span class="hljs-keyword">init</span>=function()&#123;<br>                window.addEventListener(<span class="hljs-string">&#x27;load&#x27;</span>,<span class="hljs-keyword">this</span>.refresh.bind(<span class="hljs-keyword">this</span>),<span class="hljs-literal">false</span>)<br>                window.addEventListener(<span class="hljs-string">&#x27;hashchange&#x27;</span>,<span class="hljs-keyword">this</span>.refresh.bind(<span class="hljs-keyword">this</span>),<span class="hljs-literal">false</span>)<br>            &#125;<br>        &#125;<br> <br>        let res=document.getElementById(<span class="hljs-string">&#x27;div&#x27;</span>)<br>        let R=new Router()<br>        <span class="hljs-comment">//触发监听</span><br>        R.<span class="hljs-keyword">init</span>()<br>        R.route(<span class="hljs-string">&#x27;/&#x27;</span>,function()&#123;<br>            res.style.backgroundColor=<span class="hljs-string">&#x27;pink&#x27;</span><br>            res.innerHTML=<span class="hljs-string">&#x27;11111&#x27;</span><br>        &#125;)<br></code></pre></td></tr></table></figure>

<h2 id="38-斐波那契数列"><a href="#38-斐波那契数列" class="headerlink" title="38.斐波那契数列"></a>38.斐波那契数列</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// 尾递归</span><br><span class="hljs-keyword">function</span> <span class="hljs-constructor">Fibonacci(<span class="hljs-params">n</span>,<span class="hljs-params">num</span>=1,<span class="hljs-params">sum</span>=1)</span>&#123;<br><br>    <span class="hljs-keyword">if</span> (n&lt;=<span class="hljs-number">2</span>)&#123;<br>        return sum;<br>    &#125;<br>    return <span class="hljs-constructor">Fibonacci(<span class="hljs-params">n</span>-1,<span class="hljs-params">sum</span>,<span class="hljs-params">num</span>+<span class="hljs-params">sum</span>)</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> feibo3(n) &#123;<br>  <span class="hljs-keyword">let</span> pre = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">let</span> cur = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++) &#123;<br>    <span class="hljs-literal">[<span class="hljs-identifier">pre</span>, <span class="hljs-identifier">cur</span>]</span> = <span class="hljs-literal">[<span class="hljs-identifier">cur</span>, <span class="hljs-identifier">cur</span> + <span class="hljs-identifier">pre</span>]</span>;<br>  &#125;<br>  return cur;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="39-使用-setTimeout-实现-setInterval"><a href="#39-使用-setTimeout-实现-setInterval" class="headerlink" title="39.使用 setTimeout 实现 setInterval"></a>39.使用 setTimeout 实现 setInterval</h2><p>使用 setTimeout 递归调用来模拟 setInterval，确保了只有一个事件结束了，才会触发下一个定时器事件。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">function</span> my<span class="hljs-constructor">SetInterval(<span class="hljs-params">fn</span>, <span class="hljs-params">timeout</span>)</span> &#123;<br>  <span class="hljs-comment">// 控制器，控制定时器是否继续执行</span><br>  var timer = &#123;<br>    flag: <span class="hljs-literal">true</span><br>  &#125;;<br>  <span class="hljs-comment">// 设置递归函数，模拟定时器执行。</span><br>  <span class="hljs-keyword">function</span> interval<span class="hljs-literal">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (timer.flag) &#123;<br>      fn<span class="hljs-literal">()</span>;<br>      set<span class="hljs-constructor">Timeout(<span class="hljs-params">interval</span>, <span class="hljs-params">timeout</span>)</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-comment">// 启动定时器</span><br>  set<span class="hljs-constructor">Timeout(<span class="hljs-params">interval</span>, <span class="hljs-params">timeout</span>)</span>;<br>  <span class="hljs-comment">// 返回控制器</span><br>  return timer;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="40-jsonp"><a href="#40-jsonp" class="headerlink" title="40.jsonp"></a>40.jsonp</h2><h3 id="JSONP-原理"><a href="#JSONP-原理" class="headerlink" title="JSONP 原理"></a>JSONP 原理</h3><ol>
<li>定义好回调函数，比方说命名为 callback ，并将函数名作为 url 的参数；</li>
<li>添加 script 标签，指定的资源为目标域的方法，也就是上面的 url ；</li>
<li>后端接收 GET 请求，返回 <code>callback(responseData)</code> 格式数据，把要返回的数据 responseData 传到 <code>callback()</code> 中；</li>
<li>前端接收 javaScript 内容，执行了后端返回的 <code>callback(responseData)</code> ，这样就完成了一次前后端交互了。</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// 动态的加载js文件</span><br><span class="hljs-keyword">function</span> add<span class="hljs-constructor">Script(<span class="hljs-params">src</span>)</span> &#123;<br>  const script = document.create<span class="hljs-constructor">Element(&#x27;<span class="hljs-params">script</span>&#x27;)</span>;<br>  script.src = src;<br>  script.<span class="hljs-keyword">type</span> = <span class="hljs-string">&quot;text/javascript&quot;</span>;<br>  document.body.append<span class="hljs-constructor">Child(<span class="hljs-params">script</span>)</span>;<br>&#125;<br>add<span class="hljs-constructor">Script(<span class="hljs-string">&quot;http://xxx.xxx.com/xxx.js?callback=handleRes&quot;</span>)</span>;<br><span class="hljs-comment">// 设置一个全局的callback函数来接收回调结果</span><br><span class="hljs-keyword">function</span> handle<span class="hljs-constructor">Res(<span class="hljs-params">res</span>)</span> &#123;<br>  console.log(res);<br>&#125;<br><span class="hljs-comment">// 接口返回的数据格式</span><br>handle<span class="hljs-constructor">Res(&#123;<span class="hljs-params">a</span>: 1, <span class="hljs-params">b</span>: 2&#125;)</span>;<br></code></pre></td></tr></table></figure>

<h2 id="41-判断对象是否存在循环引用"><a href="#41-判断对象是否存在循环引用" class="headerlink" title="41.判断对象是否存在循环引用"></a>41.判断对象是否存在循环引用</h2><p>对象循环引用会导致垃圾回收机制无法正确回收这些对象，从而导致内存泄漏，使得程序消耗更多的内存，直到最终内存耗尽，导致程序崩溃。</p>
<p>具体来说，当出现循环引用的情况时，垃圾回收机制会出现一些问题。因为垃圾回收机制是通过遍历对象的引用关系来确定哪些对象不再被引用，从而将它们标记为垃圾并回收。但是，当对象之间存在循环引用时，垃圾回收机制无法确定哪些对象是垃圾，哪些对象还在使用中，从而导致无法正确回收垃圾对象，造成内存泄漏。</p>
<p>此外，对象循环引用也会影响程序的性能和稳定性。当内存不足时，程序会变得非常缓慢，甚至无法响应用户的操作，最终导致程序崩溃。</p>
<p><code>JSON.stringify</code>将对象转换为字符串时，会抛出异常。</p>
<p>这是因为在进行对象字符串化时，字符串化工具会尝试遍历整个对象，并将对象中的所有属性都转换为字符串。如果对象中存在循环引用，字符串化工具会陷入死循环，无法正常完成操作。为了防止这种情况发生，字符串化工具会检测对象中是否存在循环引用，如果存在，就会抛出异常，防止程序陷入死循环。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">function</span> has<span class="hljs-constructor">CircularReference(<span class="hljs-params">obj</span>)</span> &#123;<br>  <span class="hljs-keyword">let</span> hasCircular = <span class="hljs-literal">false</span>;<br>  const seenObjects = <span class="hljs-keyword">new</span> <span class="hljs-constructor">WeakSet()</span>; <span class="hljs-comment">// 使用WeakSet来存储已经遍历过的对象</span><br><br>  <span class="hljs-keyword">function</span> detect<span class="hljs-constructor">CircularReference(<span class="hljs-params">obj</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (typeof obj<span class="hljs-operator"> === </span>&#x27;<span class="hljs-keyword">object</span>&#x27;<span class="hljs-operator"> &amp;&amp; </span>obj !== null) &#123;<br>      <span class="hljs-keyword">if</span> (seenObjects.has(obj)) &#123;<br>        hasCircular = <span class="hljs-literal">true</span>;<br>        return;<br>      &#125;<br>      seenObjects.add(obj); <span class="hljs-comment">// 标记该对象已经被遍历过</span><br>      <span class="hljs-keyword">for</span> (const key <span class="hljs-keyword">in</span> obj) &#123;<br>        detect<span class="hljs-constructor">CircularReference(<span class="hljs-params">obj</span>[<span class="hljs-params">key</span>])</span>; <span class="hljs-comment">// 遍历该对象的属性</span><br>      &#125;<br>    &#125;<br>  &#125;<br><br>  detect<span class="hljs-constructor">CircularReference(<span class="hljs-params">obj</span>)</span>;<br>  return hasCircular;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="42-继承"><a href="#42-继承" class="headerlink" title="42.继承"></a>42.继承</h2><h3 id="寄生组合式继承"><a href="#寄生组合式继承" class="headerlink" title="寄生组合式继承"></a>寄生组合式继承</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">clone</span> (parent, child) &#123;<br>    <span class="hljs-comment">// 这里改用 Object.create 就可以减少组合继承中多进行一次构造的过程</span><br>    child.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(parent.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);<span class="hljs-comment">//*****</span><br>    child.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = child;<span class="hljs-comment">//*****</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent6</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;parent6&#x27;</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">play</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br>&#125;<br><span class="hljs-title class_">Parent6</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Child6</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Parent6</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">//*****</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">friends</span> = <span class="hljs-string">&#x27;child5&#x27;</span>;<br>&#125;<br><br><span class="hljs-title function_">clone</span>(<span class="hljs-title class_">Parent6</span>, <span class="hljs-title class_">Child6</span>);<br><br><span class="hljs-title class_">Child6</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getFriends</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">friends</span>;<br>&#125;<br><br><span class="hljs-keyword">let</span> person6 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child6</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person6); <span class="hljs-comment">//&#123;friends:&quot;child5&quot;,name:&quot;child5&quot;,play:[1,2,3],__proto__:Parent6&#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person6.<span class="hljs-title function_">getName</span>()); <span class="hljs-comment">// parent6</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person6.<span class="hljs-title function_">getFriends</span>()); <span class="hljs-comment">// child5</span><br></code></pre></td></tr></table></figure>

<h3 id="原型链继承"><a href="#原型链继承" class="headerlink" title="原型链继承"></a>原型链继承</h3><p>原型链继承是比较常见的继承方式之一，其中涉及的构造函数、原型和实例，三者之间存在着一定的关系，即每一个构造函数都有一个原型对象，原型对象又包含一个指向构造函数的指针，而实例则包含一个原型对象的指针</p>
<p>举个例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"></span>) &#123;<br>   <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;parent1&#x27;</span>;<br>   <span class="hljs-variable language_">this</span>.<span class="hljs-property">play</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br> &#125;<br> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"></span>) &#123;<br>   <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;child2&#x27;</span>;<br> &#125;<br> <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Parent</span>();<br> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>())<br></code></pre></td></tr></table></figure>

<p>上面代码看似没问题，实际存在潜在问题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> s1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>();<br><span class="hljs-keyword">var</span> s2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>();<br>s1.<span class="hljs-property">play</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s1.<span class="hljs-property">play</span>, s2.<span class="hljs-property">play</span>); <span class="hljs-comment">// [1,2,3,4]</span><br></code></pre></td></tr></table></figure>

<p>改变<code>s1</code>的<code>play</code>属性，会发现<code>s2</code>也跟着发生变化了，这是因为两个实例使用的是同一个原型对象，内存空间是共享的</p>
<h3 id="构造函数继承"><a href="#构造函数继承" class="headerlink" title="构造函数继承"></a>构造函数继承</h3><p>借助 <code>call</code>调用<code>Parent</code>函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;parent1&#x27;</span>;<br>&#125;<br><br><span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Parent1</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;child&#x27;</span><br>&#125;<br><br><span class="hljs-keyword">let</span> child = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child);  <span class="hljs-comment">// 没问题</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-title function_">getName</span>());  <span class="hljs-comment">// 会报错</span><br></code></pre></td></tr></table></figure>

<p>可以看到，父类原型对象中一旦存在父类之前自己定义的方法，那么子类将无法继承这些方法</p>
<p>相比第一种原型链继承方式，父类的引用属性不会被共享，优化了第一种继承方式的弊端，但是只能继承父类的实例属性和方法，不能继承原型属性或者方法</p>
<h3 id="组合继承"><a href="#组合继承" class="headerlink" title="组合继承"></a>组合继承</h3><p>前面我们讲到两种继承方式，各有优缺点。组合继承则将前两种方式继承起来</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent3</span> () &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;parent3&#x27;</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">play</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br>&#125;<br><br><span class="hljs-title class_">Parent3</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Child3</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 第二次调用 Parent3()</span><br>    <span class="hljs-title class_">Parent3</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;child3&#x27;</span>;<br>&#125;<br><br><span class="hljs-comment">// 第一次调用 Parent3()</span><br><span class="hljs-title class_">Child3</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Parent3</span>();<br><span class="hljs-comment">// 手动挂上构造器，指向自己的构造函数</span><br><span class="hljs-title class_">Child3</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child3</span>;<br><span class="hljs-keyword">var</span> s3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child3</span>();<br><span class="hljs-keyword">var</span> s4 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child3</span>();<br>s3.<span class="hljs-property">play</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s3.<span class="hljs-property">play</span>, s4.<span class="hljs-property">play</span>);  <span class="hljs-comment">// 不互相影响</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s3.<span class="hljs-title function_">getName</span>()); <span class="hljs-comment">// 正常输出&#x27;parent3&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s4.<span class="hljs-title function_">getName</span>()); <span class="hljs-comment">// 正常输出&#x27;parent3&#x27;</span><br></code></pre></td></tr></table></figure>

<p>这种方式看起来就没什么问题，方式一和方式二的问题都解决了，但是从上面代码我们也可以看到<code>Parent3</code> 执行了两次，造成了多构造一次的性能开销</p>
<h3 id="原型式继承"><a href="#原型式继承" class="headerlink" title="原型式继承"></a>原型式继承</h3><p>这里主要借助<code>Object.create</code>方法实现普通对象的继承</p>
<p>同样举个例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> parent4 = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;parent4&quot;</span>,<br>    <span class="hljs-attr">friends</span>: [<span class="hljs-string">&quot;p1&quot;</span>, <span class="hljs-string">&quot;p2&quot;</span>, <span class="hljs-string">&quot;p3&quot;</span>],<br>    <span class="hljs-attr">getName</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>    &#125;<br>  &#125;;<br><br>  <span class="hljs-keyword">let</span> person4 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(parent4);<br>  person4.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;tom&quot;</span>;<br>  person4.<span class="hljs-property">friends</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">&quot;jerry&quot;</span>);<br><br>  <span class="hljs-keyword">let</span> person5 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(parent4);<br>  person5.<span class="hljs-property">friends</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">&quot;lucy&quot;</span>);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person4.<span class="hljs-property">name</span>); <span class="hljs-comment">// tom</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person4.<span class="hljs-property">name</span> === person4.<span class="hljs-title function_">getName</span>()); <span class="hljs-comment">// true</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person5.<span class="hljs-property">name</span>); <span class="hljs-comment">// parent4</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person4.<span class="hljs-property">friends</span>); <span class="hljs-comment">// [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;,&quot;jerry&quot;,&quot;lucy&quot;]</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person5.<span class="hljs-property">friends</span>); <span class="hljs-comment">// [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;,&quot;jerry&quot;,&quot;lucy&quot;]</span><br></code></pre></td></tr></table></figure>

<p>这种继承方式的缺点也很明显，因为<code>Object.create</code>方法实现的是浅拷贝，多个实例的引用类型属性指向相同的内存，存在篡改的可能</p>
<h3 id="寄生式继承"><a href="#寄生式继承" class="headerlink" title="寄生式继承"></a>寄生式继承</h3><p>寄生式继承在上面继承基础上进行优化，利用这个浅拷贝的能力再进行增强，添加一些方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> parent5 = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;parent5&quot;</span>,<br>    <span class="hljs-attr">friends</span>: [<span class="hljs-string">&quot;p1&quot;</span>, <span class="hljs-string">&quot;p2&quot;</span>, <span class="hljs-string">&quot;p3&quot;</span>],<br>    <span class="hljs-attr">getName</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">clone</span>(<span class="hljs-params">original</span>) &#123;<br>    <span class="hljs-keyword">let</span> clone = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(original);<br>    clone.<span class="hljs-property">getFriends</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">friends</span>;<br>    &#125;;<br>    <span class="hljs-keyword">return</span> clone;<br>&#125;<br><br><span class="hljs-keyword">let</span> person5 = <span class="hljs-title function_">clone</span>(parent5);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person5.<span class="hljs-title function_">getName</span>()); <span class="hljs-comment">// parent5</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person5.<span class="hljs-title function_">getFriends</span>()); <span class="hljs-comment">// [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;]</span><br></code></pre></td></tr></table></figure>

<p>其优缺点也很明显，跟上面讲的原型式继承一样</p>
<h2 id="43-异步操作串并行执行"><a href="#43-异步操作串并行执行" class="headerlink" title="43.异步操作串并行执行"></a>43.异步操作串并行执行</h2><h3 id="串行执行"><a href="#串行执行" class="headerlink" title="串行执行"></a>串行执行</h3><p>reduce 方法的第一个参数是一个异步函数，它将前一个异步操作的 Promise 对象作为参数传递给下一个异步操作。reduce 方法的第二个参数是一个 Promise 对象，它的值为 undefined。在每次调用 reduce 方法时，都会等待前一个异步操作执行完毕之后再执行下一个异步操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sequentialAsync</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> asyncFunctions = [asyncFunction1, asyncFunction2, asyncFunction3];<br><br>  <span class="hljs-keyword">return</span> asyncFunctions.<span class="hljs-title function_">reduce</span>(<span class="hljs-keyword">async</span> (previousPromise, asyncFunction) =&gt; &#123;<br>    <span class="hljs-keyword">await</span> previousPromise;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">asyncFunction</span>();<br>  &#125;, <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>());<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="并行执行"><a href="#并行执行" class="headerlink" title="并行执行"></a>并行执行</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">parallelAsync</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> [result1, result2, result3] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<br>    <span class="hljs-title function_">asyncFunction1</span>(),<br>    <span class="hljs-title function_">asyncFunction2</span>(),<br>    <span class="hljs-title function_">asyncFunction3</span>(),<br>  ]);<br><br>  <span class="hljs-comment">// 处理异步操作的结果</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="并行与串行的结合"><a href="#并行与串行的结合" class="headerlink" title="并行与串行的结合"></a>并行与串行的结合</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Scheduler</span> </span>&#123;<br>  <span class="hljs-keyword">constructor</span>(max) &#123;<br>    <span class="hljs-comment">// 最大可并发任务数</span><br>    <span class="hljs-keyword">this</span>.max = max;<br>    <span class="hljs-comment">// 当前并发任务数</span><br>    <span class="hljs-keyword">this</span>.count = <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">// 任务队列</span><br>    <span class="hljs-keyword">this</span>.queue = [];<br>  &#125;<br><br>  add(fn) &#123;<br>    <span class="hljs-keyword">this</span>.queue.push(fn)<br>    <span class="hljs-keyword">this</span>.run()<br>  &#125;<br>  run() &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.count &gt;= <span class="hljs-keyword">this</span>.max || <span class="hljs-keyword">this</span>.queue.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">this</span>.count++<br>    Promise.resolve(<span class="hljs-keyword">this</span>.queue.shift()()).<span class="hljs-keyword">finally</span>(() =&gt; &#123;<br>      <span class="hljs-keyword">this</span>.count--<br>      <span class="hljs-keyword">this</span>.run()<br>    &#125;)<br>  &#125;<br>&#125;<br><span class="hljs-comment">// ------------test-------------------</span><br><span class="hljs-comment">// 延迟函数</span><br><span class="hljs-keyword">const</span> sleep = time =&gt; new Promise(resolve =&gt; setTimeout(resolve, time));<br><br><span class="hljs-comment">// 同时进行的任务最多2个</span><br><span class="hljs-keyword">const</span> scheduler = new Scheduler(<span class="hljs-number">2</span>);<br><br><span class="hljs-comment">// 添加异步任务</span><br><span class="hljs-comment">// time: 任务执行的时间</span><br><span class="hljs-comment">// val: 参数</span><br><span class="hljs-keyword">const</span> addTask = (time, <span class="hljs-keyword">val</span>) =&gt; &#123;<br>  scheduler.add(() =&gt; &#123;<br>    <span class="hljs-keyword">return</span> sleep(time).then(() =&gt; console.log(<span class="hljs-keyword">val</span>));<br>  &#125;);<br>&#125;;<br><br>addTask(<span class="hljs-number">1000</span>, <span class="hljs-string">&#x27;1&#x27;</span>);<br>addTask(<span class="hljs-number">500</span>, <span class="hljs-string">&#x27;2&#x27;</span>);<br>addTask(<span class="hljs-number">300</span>, <span class="hljs-string">&#x27;3&#x27;</span>);<br>addTask(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;4&#x27;</span>);<br><span class="hljs-comment">// 2</span><br><span class="hljs-comment">// 3</span><br><span class="hljs-comment">// 1</span><br><span class="hljs-comment">// 4</span><br></code></pre></td></tr></table></figure>

<h2 id="44-对象的扁平化"><a href="#44-对象的扁平化" class="headerlink" title="44.对象的扁平化"></a>44.对象的扁平化</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">flattenObject</span>(<span class="hljs-params">obj, prefix = <span class="hljs-string">&#x27;&#x27;</span></span>) &#123;<br>  <span class="hljs-keyword">let</span> result = &#123;&#125;;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(obj, key)) &#123;<br>      <span class="hljs-keyword">const</span> propName = prefix ? <span class="hljs-string">`<span class="hljs-subst">$&#123;prefix&#125;</span>.<span class="hljs-subst">$&#123;key&#125;</span>`</span> : key;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj[key] === <span class="hljs-string">&#x27;object&#x27;</span> &amp;&amp; obj[key] !== <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(result, <span class="hljs-title function_">flattenObject</span>(obj[key], propName));<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        result[propName] = obj[key];<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">//</span><br><span class="hljs-keyword">const</span> obj = &#123;<br>  <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">b</span>: &#123;<br>    <span class="hljs-attr">c</span>: <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">d</span>: &#123;<br>      <span class="hljs-attr">e</span>: <span class="hljs-number">3</span>,<br>      <span class="hljs-attr">f</span>: <span class="hljs-number">4</span><br>    &#125;<br>  &#125;<br>&#125;;<br><span class="hljs-comment">//</span><br>&#123;<br>  <span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">1</span>,<br>  <span class="hljs-string">&quot;b.c&quot;</span>: <span class="hljs-number">2</span>,<br>  <span class="hljs-string">&quot;b.d.e&quot;</span>: <span class="hljs-number">3</span>,<br>  <span class="hljs-string">&quot;b.d.f&quot;</span>: <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="45-版本号排序"><a href="#45-版本号排序" class="headerlink" title="45.版本号排序"></a>45.版本号排序</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript">arr.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">const</span> arr1 = a.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;.&quot;</span>);<br>  <span class="hljs-keyword">const</span> arr2 = b.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;.&quot;</span>);<br><br>  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>    <span class="hljs-keyword">const</span> s1 = arr1[i];<br>    <span class="hljs-keyword">const</span> s2 = arr2[i];<br>    i++;<br>    <span class="hljs-keyword">if</span> (s1 === <span class="hljs-literal">undefined</span> || s2 === <span class="hljs-literal">undefined</span>) &#123;<br>      <span class="hljs-keyword">return</span> arr1.<span class="hljs-property">length</span> - arr2.<span class="hljs-property">length</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (s1 === s2) <span class="hljs-keyword">continue</span>;<br><br>    <span class="hljs-keyword">return</span> s1 - s2;<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>

<h2 id="46-DOM-节点输出为-JSON-格式"><a href="#46-DOM-节点输出为-JSON-格式" class="headerlink" title="46.DOM 节点输出为 JSON 格式"></a>46.DOM 节点输出为 JSON 格式</h2><p>要将一个 DOM 节点输出为 JSON 格式，需要考虑节点的以下属性：</p>
<ol>
<li>tagName - 节点的标签名。</li>
<li>attributes - 节点的属性，需要遍历所有属性并以键值对的形式存储。</li>
<li>childNodes - 节点的子节点，需要递归地对每个子节点进行相同的操作。</li>
</ol>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">nodeToJson</span>(<span class="hljs-params">node</span>) &#123;<br>  <span class="hljs-keyword">var</span> obj = &#123;&#125;;<br>  obj[<span class="hljs-string">&#x27;tagName&#x27;</span>] = node.tagName.toLowerCase();<br><br>  <span class="hljs-keyword">if</span> (node.attributes) &#123;<br>    <span class="hljs-keyword">var</span> attrs = &#123;&#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; node.attributes.<span class="hljs-built_in">length</span>; i++) &#123;<br>      <span class="hljs-keyword">var</span> attr = node.attributes[i];<br>      attrs[attr.nodeName] = attr.nodeValue;<br>    &#125;<br>    obj[<span class="hljs-string">&#x27;attributes&#x27;</span>] = attrs;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (node.childNodes &amp;&amp; node.childNodes.<span class="hljs-built_in">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">var</span> children = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; node.childNodes.<span class="hljs-built_in">length</span>; j++) &#123;<br>      <span class="hljs-keyword">var</span> childNode = node.childNodes[j];<br>      <span class="hljs-keyword">if</span> (childNode.nodeType === Node.ELEMENT_NODE) &#123;<br>        children.<span class="hljs-built_in">push</span>(nodeToJson(childNode));<br>      &#125;<br>    &#125;<br>    obj[<span class="hljs-string">&#x27;childNodes&#x27;</span>] = children;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> obj;<br>&#125;<br><br><span class="hljs-comment">//</span><br><span class="hljs-keyword">var</span> node = document.getElementById(<span class="hljs-string">&#x27;my-element&#x27;</span>);<br><span class="hljs-keyword">var</span> json = nodeToJson(node);<br><br></code></pre></td></tr></table></figure>

<h2 id="47-JSON-格式输出为DOM-节点"><a href="#47-JSON-格式输出为DOM-节点" class="headerlink" title="47.JSON 格式输出为DOM 节点"></a>47.JSON 格式输出为DOM 节点</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// 真正的渲染函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-constructor">_render(<span class="hljs-params">vnode</span>)</span> &#123;<br>  <span class="hljs-comment">// 如果是数字类型转化为字符串</span><br>  <span class="hljs-keyword">if</span> (typeof vnode<span class="hljs-operator"> === </span><span class="hljs-string">&quot;number&quot;</span>) &#123;<br>    vnode = <span class="hljs-constructor">String(<span class="hljs-params">vnode</span>)</span>;<br>  &#125;<br>  <span class="hljs-comment">// 字符串类型直接就是文本节点</span><br>  <span class="hljs-keyword">if</span> (typeof vnode<span class="hljs-operator"> === </span><span class="hljs-string">&quot;string&quot;</span>) &#123;<br>    return document.create<span class="hljs-constructor">TextNode(<span class="hljs-params">vnode</span>)</span>;<br>  &#125;<br>  <span class="hljs-comment">// 普通DOM</span><br>  const dom = document.create<span class="hljs-constructor">Element(<span class="hljs-params">vnode</span>.<span class="hljs-params">tag</span>)</span>;<br>  <span class="hljs-keyword">if</span><span class="hljs-function"> (<span class="hljs-params">vnode.attributes)</span> &#123;</span><br><span class="hljs-function">    // 遍历属性</span><br><span class="hljs-function">    O<span class="hljs-params">bject.keys(vnode.attributes)</span>.<span class="hljs-params">forEach((key)</span> =&gt;</span> &#123;<br>      const value = vnode.attributes<span class="hljs-literal">[<span class="hljs-identifier">key</span>]</span>;<br>      dom.set<span class="hljs-constructor">Attribute(<span class="hljs-params">key</span>, <span class="hljs-params">value</span>)</span>;<br>    &#125;);<br>  &#125;<br>  <span class="hljs-comment">// 子数组进行递归操作</span><br>  vnode.children.<span class="hljs-keyword">for</span><span class="hljs-constructor">Each((<span class="hljs-params">child</span>)</span> =&gt; dom.append<span class="hljs-constructor">Child(<span class="hljs-params">_render</span>(<span class="hljs-params">child</span>)</span>));<br>  return dom;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="48-Array-prototype-reduce"><a href="#48-Array-prototype-reduce" class="headerlink" title="48.Array.prototype.reduce"></a>48.Array.prototype.reduce</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript">使用方法<br>array.<span class="hljs-title function_">reduce</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">accumulator, currentValue, index, array</span>) &#123;<br>  <span class="hljs-comment">// return updated accumulator</span><br>&#125;, initialValue)<br>其中，参数 <span class="hljs-keyword">function</span>(<span class="hljs-params">accumulator, currentValue, index, array</span>) 是一个回调函数，用于处理每个数组元素并更新累加器的值。回调函数接受四个参数：<br><br><span class="hljs-attr">accumulator</span>: 累加器的值，初始值为 initialValue<br><span class="hljs-attr">currentValue</span>: 当前数组元素的值<br><span class="hljs-attr">index</span>: 当前数组元素的索引<br><span class="hljs-attr">array</span>: 原始数组<br>实现方法<br><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">reduce</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">callback, initialValue</span>) &#123;<br>  <span class="hljs-keyword">var</span> accumulator = (initialValue !== <span class="hljs-literal">undefined</span>) ? initialValue : <span class="hljs-variable language_">this</span>[<span class="hljs-number">0</span>];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = (initialValue !== <span class="hljs-literal">undefined</span>) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>; i++) &#123;<br>    accumulator = callback.<span class="hljs-title function_">call</span>(<span class="hljs-literal">undefined</span>, accumulator, <span class="hljs-variable language_">this</span>[i], i, <span class="hljs-variable language_">this</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> accumulator;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="49-实现一个事件委托（易错）"><a href="#49-实现一个事件委托（易错）" class="headerlink" title="49.实现一个事件委托（易错）"></a>49.实现一个事件委托（易错）</h2><p>事件委托这里就不阐述了，比如给li绑定点击事件</p>
<p>看错误版，(容易过的，看<strong>「面试官水平了」</strong>)👇</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript">ul.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e,e.<span class="hljs-property">target</span>)<br>            <span class="hljs-keyword">if</span> (e.<span class="hljs-property">target</span>.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>() === <span class="hljs-string">&#x27;li&#x27;</span>) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;打印&#x27;</span>)  <span class="hljs-comment">// 模拟fn</span><br>            &#125;<br>&#125;)<br>复制代码<br></code></pre></td></tr></table></figure>

<p><strong>「有个小bug，如果用户点击的是 li 里面的 span，就没法触发 fn，这显然不对」</strong>👇</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css">&lt;<span class="hljs-selector-tag">ul</span> id=&quot;xxx&quot;&gt;下面的内容是子元素<span class="hljs-number">1</span><br>        &lt;<span class="hljs-selector-tag">li</span>&gt;<span class="hljs-selector-tag">li</span>内容&gt;&gt;&gt; &lt;<span class="hljs-selector-tag">span</span>&gt; 这是<span class="hljs-selector-tag">span</span>内容<span class="hljs-number">123</span>&lt;/<span class="hljs-selector-tag">span</span>&gt;&lt;/<span class="hljs-selector-tag">li</span>&gt;<br>        下面的内容是子元素<span class="hljs-number">2</span><br>        &lt;<span class="hljs-selector-tag">li</span>&gt;<span class="hljs-selector-tag">li</span>内容&gt;&gt;&gt; &lt;<span class="hljs-selector-tag">span</span>&gt; 这是<span class="hljs-selector-tag">span</span>内容<span class="hljs-number">123</span>&lt;/<span class="hljs-selector-tag">span</span>&gt;&lt;/<span class="hljs-selector-tag">li</span>&gt;<br>        下面的内容是子元素<span class="hljs-number">3</span><br>        &lt;<span class="hljs-selector-tag">li</span>&gt;<span class="hljs-selector-tag">li</span>内容&gt;&gt;&gt; &lt;<span class="hljs-selector-tag">span</span>&gt; 这是<span class="hljs-selector-tag">span</span>内容<span class="hljs-number">123</span>&lt;/<span class="hljs-selector-tag">span</span>&gt;&lt;/<span class="hljs-selector-tag">li</span>&gt;<br>&lt;/<span class="hljs-selector-tag">ul</span>&gt;<br>复制代码<br></code></pre></td></tr></table></figure>

<p>这样子的场景就是不对的，那我们看看高级版本👇</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ini">function delegate(element, eventType, selector, fn) &#123;<br>          element.addEventListener(eventType, <span class="hljs-attr">e</span> =&gt; &#123;<br>              let <span class="hljs-attr">el</span> = e.target<br>              while (!el.matches(selector)) &#123;<br>                  if (<span class="hljs-attr">element</span> === el) &#123;<br>                      <span class="hljs-attr">el</span> = null<br>                      break<br>                  &#125;<br>                  <span class="hljs-attr">el</span> = el.parentNode<br>              &#125;<br>              el &amp;&amp; fn.call(el, e, el)<br>          &#125;,true)<br>          return element<br>      &#125;<br></code></pre></td></tr></table></figure>

<h2 id="50-事件的代理"><a href="#50-事件的代理" class="headerlink" title="50.事件的代理"></a>50.事件的代理</h2><p>由于事件会在冒泡阶段向上传播到父节点，因此可以把子节点的监听函数定义在父节点上，由父节点的监听函数统一处理多个子元素的事件。这种方法叫做事件的代理。</p>
<p><strong>事件委托的优点</strong></p>
<ul>
<li>只需要将同类元素的事件委托给父级或者更外级的元素，不需要给所有的元素都绑定事件，减少内存占用空间，提升性能。</li>
<li>动态新增的元素无需重新绑定事件</li>
</ul>
<p>错误版：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">ul.add<span class="hljs-constructor">EventListener(&#x27;<span class="hljs-params">click</span>&#x27;, <span class="hljs-params">function</span>(<span class="hljs-params">e</span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(e.target.tagName.<span class="hljs-keyword">to</span><span class="hljs-constructor">LowerCase()</span><span class="hljs-operator"> === </span>&#x27;li&#x27;)&#123;<br>        fn<span class="hljs-literal">()</span> <span class="hljs-comment">// 执行某个函数</span><br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>正确版：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">function</span> <span class="hljs-title">delegate</span><span class="hljs-params">(element, eventType, selector, fn)</span> &#123;<br>     element.addEventListener(eventType, <span class="hljs-keyword">e</span> =&gt; &#123;<br>       <span class="hljs-keyword">let</span> <span class="hljs-keyword">el</span> = <span class="hljs-keyword">e</span>.target<br>       <span class="hljs-keyword">while</span> (!el.matches(selector)) &#123;<br>         <span class="hljs-keyword">if</span> (element === <span class="hljs-keyword">el</span>) &#123;<br>           <span class="hljs-keyword">el</span> = null<br>           <span class="hljs-keyword">break</span><br>         &#125;<br>         <span class="hljs-keyword">el</span> = <span class="hljs-keyword">el</span>.parentNode<br>       &#125;<br>       <span class="hljs-keyword">el</span> &amp;&amp; fn.<span class="hljs-keyword">call</span>(<span class="hljs-keyword">el</span>, <span class="hljs-keyword">e</span>, <span class="hljs-keyword">el</span>)<br>     &#125;)<br>     <span class="hljs-keyword">return</span> element<br>   &#125;<br></code></pre></td></tr></table></figure>

<h2 id="51-大数相加"><a href="#51-大数相加" class="headerlink" title="51.大数相加"></a>51.大数相加</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">function</span> add(a ,b)&#123;<br>   <span class="hljs-comment">//取两个数字的最大长度</span><br>   <span class="hljs-keyword">let</span> maxLength = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Math</span>.</span></span>max(a.length, b.length);<br>   <span class="hljs-comment">//用0去补齐长度</span><br>   a = a.pad<span class="hljs-constructor">Start(<span class="hljs-params">maxLength</span> , 0)</span>;<span class="hljs-comment">//&quot;0009007199254740991&quot;</span><br>   b = b.pad<span class="hljs-constructor">Start(<span class="hljs-params">maxLength</span> , 0)</span>;<span class="hljs-comment">//&quot;1234567899999999999&quot;</span><br>   <span class="hljs-comment">//定义加法过程中需要用到的变量</span><br>   <span class="hljs-keyword">let</span> t = <span class="hljs-number">0</span>;<br>   <span class="hljs-keyword">let</span> f = <span class="hljs-number">0</span>;   <span class="hljs-comment">//&quot;进位&quot;</span><br>   <span class="hljs-keyword">let</span> sum = <span class="hljs-string">&quot;&quot;</span>;<br>   <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=maxLength-<span class="hljs-number">1</span> ; i&gt;=<span class="hljs-number">0</span> ; i--)&#123;<br>      t = <span class="hljs-constructor">Number(<span class="hljs-params">a</span>[<span class="hljs-params">i</span>])</span> + <span class="hljs-constructor">Number(<span class="hljs-params">b</span>[<span class="hljs-params">i</span>])</span> + f;<br>      f = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Math</span>.</span></span>floor(t/<span class="hljs-number">10</span>);<br>      sum = t%<span class="hljs-number">10</span> + sum;<br>   &#125;<br>   <span class="hljs-keyword">if</span>(f!==<span class="hljs-number">0</span>)&#123;<br>      sum = &#x27;&#x27; + f + sum;<br>   &#125;<br>   return sum;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="52-模板字符串解析功能"><a href="#52-模板字符串解析功能" class="headerlink" title="52.模板字符串解析功能"></a>52.模板字符串解析功能</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> template = <span class="hljs-string">&#x27;我是&#123;&#123;name&#125;&#125;，年龄&#123;&#123;age&#125;&#125;，性别&#123;&#123;sex&#125;&#125;&#x27;</span>;<br><span class="hljs-keyword">let</span> data = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>&#125;<br><span class="hljs-title function_">render</span>(template, data); <span class="hljs-comment">// 我是姓名，年龄18，性别undefined</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">template, data</span>) &#123;<br>  <span class="hljs-keyword">let</span> computed = template.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;(\w+)\&#125;\&#125;/g</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">match, key</span>) &#123;<br>    <span class="hljs-keyword">return</span> data[key];<br>  &#125;);<br>  <span class="hljs-keyword">return</span> computed;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="53-列表转成树形结构"><a href="#53-列表转成树形结构" class="headerlink" title="53.列表转成树形结构"></a>53.列表转成树形结构</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-keyword">function</span> listToTree(list) &#123;<br>            const <span class="hljs-keyword">map</span> = &#123;&#125;;<br>            const roots = [];<br>            <span class="hljs-keyword">for</span> (const <span class="hljs-type">item</span> <span class="hljs-keyword">of</span> list) &#123;<br>                const<span class="hljs-built_in"> id</span> = <span class="hljs-type">item</span><span class="hljs-built_in">.id</span>;<br>                const parentId = <span class="hljs-type">item</span>.parentId;<br>                <span class="hljs-keyword">map</span><span class="hljs-built_in">[id</span>] = &#123; ...<span class="hljs-type">item</span>, children: <span class="hljs-keyword">map</span><span class="hljs-built_in">[id</span>]?.children||[] &#125;;<br>                <span class="hljs-keyword">if</span> (parentId === <span class="hljs-number">0</span>) &#123;<br>                    roots.push(<span class="hljs-keyword">map</span><span class="hljs-built_in">[id</span>]);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">map</span>[parentId])&#123;<br>                        <span class="hljs-keyword">map</span>[parentId]=&#123;children:[]&#125;;<br>                    &#125;<br>                    <span class="hljs-keyword">map</span>[parentId].children.push(<span class="hljs-keyword">map</span><span class="hljs-built_in">[id</span>]);<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">return</span> roots;<br>         &#125;<br></code></pre></td></tr></table></figure>

<h2 id="54-树形结构转成列表"><a href="#54-树形结构转成列表" class="headerlink" title="54.树形结构转成列表"></a>54.树形结构转成列表</h2><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs abnf">function treeToList(data) &#123;<br>    let res <span class="hljs-operator">=</span> []<span class="hljs-comment">;</span><br>    const dfs <span class="hljs-operator">=</span> (tree) <span class="hljs-operator">=</span>&gt; &#123;<br>        tree.forEach((item) <span class="hljs-operator">=</span>&gt; &#123;<br>            if (item.children) &#123;<br>                dfs(item.children)<span class="hljs-comment">;</span><br>                delete item.children<span class="hljs-comment">;</span><br>            &#125;<br>            res.push(item)<span class="hljs-comment">;</span><br>        &#125;)<span class="hljs-comment">;</span><br>    &#125;<span class="hljs-comment">;</span><br>    dfs(data)<span class="hljs-comment">;</span><br>    return res<span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="55-lodash-get"><a href="#55-lodash-get" class="headerlink" title="55.lodash.get"></a>55.lodash.get</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj = &#123;<br>            <span class="hljs-attr">foo</span>: &#123;<br>                <span class="hljs-attr">bar</span>: &#123;<br>                    <span class="hljs-attr">baz</span>: <span class="hljs-string">&#x27;Hello World&#x27;</span><br>                &#125;<br>            &#125;<br>&#125;;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">source, path, defaultValue = <span class="hljs-literal">undefined</span></span>) &#123;<br>            <span class="hljs-keyword">const</span> paths = path.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;.&quot;</span>);<br>            <span class="hljs-keyword">let</span> result = source;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> p <span class="hljs-keyword">of</span> paths) &#123;<br>                <span class="hljs-keyword">if</span>(result[p]===<span class="hljs-literal">undefined</span>)&#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;<br>                &#125;<br>                result = result[p];<br>            &#125;<br>            <span class="hljs-keyword">return</span> result === <span class="hljs-literal">undefined</span> ? defaultValue : result;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">get</span>(obj, <span class="hljs-string">&#x27;foo.bar.baz&#x27;</span>));<br></code></pre></td></tr></table></figure>

<h2 id="56-将数字每千分位用逗号隔开"><a href="#56-将数字每千分位用逗号隔开" class="headerlink" title="56.将数字每千分位用逗号隔开"></a>56.将数字每千分位用逗号隔开</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs arcade">let format = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> &#123;<br>            let num = n.toString() <span class="hljs-comment">// 转成字符串</span><br>            let decimals = <span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-comment">// 判断是否有小数</span><br>            num.<span class="hljs-built_in">indexOf</span>(<span class="hljs-string">&#x27;.&#x27;</span>) &gt; <span class="hljs-number">-1</span> ? decimals = <span class="hljs-string">&#x27;.&#x27;</span>+num.<span class="hljs-built_in">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">1</span>] : decimals<br>            let len = num.<span class="hljs-built_in">length</span><br>            <span class="hljs-keyword">if</span> (len &lt;= <span class="hljs-number">3</span>) &#123;<br>                <span class="hljs-keyword">return</span> num<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                let remainder = len % <span class="hljs-number">3</span><br>                <span class="hljs-keyword">if</span> (remainder &gt; <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// 不是3的整数倍</span><br>          <span class="hljs-keyword">return</span> num.<span class="hljs-built_in">slice</span>(<span class="hljs-number">0</span>, remainder) + <span class="hljs-string">&#x27;,&#x27;</span> + num.<span class="hljs-built_in">slice</span>(remainder, len).match(<span class="hljs-regexp">/\d&#123;3&#125;/g</span>).join(<span class="hljs-string">&#x27;,&#x27;</span>) + decimals<br>                &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// 是3的整数倍</span><br>                    <span class="hljs-keyword">return</span> num.<span class="hljs-built_in">slice</span>(<span class="hljs-number">0</span>, len).match(<span class="hljs-regexp">/\d&#123;3&#125;/g</span>).join(<span class="hljs-string">&#x27;,&#x27;</span>) + temp<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(format(<span class="hljs-number">12323.33</span>));  <span class="hljs-comment">// &#x27;12,323.33&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="57-双向数据绑定"><a href="#57-双向数据绑定" class="headerlink" title="57.双向数据绑定"></a>57.双向数据绑定</h2><p>响应式也可以这这个模式写</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs stylus">双向数据绑定<br>let obj = &#123;&#125;<br>let <span class="hljs-selector-tag">input</span> = document<span class="hljs-selector-class">.getElementById</span>(<span class="hljs-string">&#x27;input&#x27;</span>)<br>let <span class="hljs-selector-tag">span</span> = document<span class="hljs-selector-class">.getElementById</span>(<span class="hljs-string">&#x27;span&#x27;</span>)<br><span class="hljs-comment">// 数据劫持</span><br>Object<span class="hljs-selector-class">.defineProperty</span>(obj, <span class="hljs-string">&#x27;text&#x27;</span>, &#123;<br>  configurable: true,<br>  enumerable: true,<br>  <span class="hljs-built_in">get</span>() &#123;<br>    console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">&#x27;获取数据了&#x27;</span>)<br>  &#125;,<br>  <span class="hljs-built_in">set</span>(newVal) &#123;<br>    console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">&#x27;数据更新了&#x27;</span>)<br>    <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.value</span> = newVal<br>    <span class="hljs-selector-tag">span</span><span class="hljs-selector-class">.innerHTML</span> = newVal<br>  &#125;<br>&#125;)<br><span class="hljs-comment">// 输入监听</span><br><span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.addEventListener</span>(<span class="hljs-string">&#x27;keyup&#x27;</span>, <span class="hljs-built_in">function</span>(e) &#123;<br>  obj<span class="hljs-selector-class">.text</span> = e<span class="hljs-selector-class">.target</span><span class="hljs-selector-class">.value</span><br>&#125;)<br><br></code></pre></td></tr></table></figure>

<h2 id="58-设计模式"><a href="#58-设计模式" class="headerlink" title="58.设计模式"></a>58.设计模式</h2><h3 id="发布订阅模式"><a href="#发布订阅模式" class="headerlink" title="发布订阅模式"></a>发布订阅模式</h3><h3 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h3><p>保证一个类只能被实例一次，每次获取的时候，如果该类已经创建过实例则直接返回该实例，否则创建一个实例保存并返回。</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;<br>    constructor(name, age) &#123;<br>        <span class="hljs-keyword">if</span> (!Singleton.instance) &#123;<br>            <span class="hljs-built_in">this</span>.name = name<br>            <span class="hljs-built_in">this</span>.age = age<br>            Singleton.instance = <span class="hljs-built_in">this</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> Singleton.instance<br>    &#125;<br>&#125;<br><br>console.log(<span class="hljs-keyword">new</span> <span class="hljs-type">Singleton</span>(<span class="hljs-string">&quot;Taobao&quot;</span>, <span class="hljs-number">18</span>) === <span class="hljs-keyword">new</span> <span class="hljs-type">Singleton</span>(<span class="hljs-string">&quot;Baidu&quot;</span>, <span class="hljs-number">15</span>)) <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure>

<p>命令模式</p>
<p>命令模式中的命令指的是一个执行某些特定的事情的指令。</p>
<p>命令模式最常见的应用场景如：有时候需要向某些对象发送请求，但是并不知道请求的接收者是谁，也不知道被请求的操作是什么。此时可以通过一种松耦合的方式来设计程序，使得请求发送者和请求接收者消除彼此之间的耦合关系。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 接收者类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Receiver</span> &#123;<br>    <span class="hljs-title function_">execute</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;接收者执行请求&#x27;</span>)<br>    &#125;<br>  &#125;<br>  <br><span class="hljs-comment">// 命令者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Command</span> &#123;  <br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">receiver</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">receiver</span> = receiver<br>    &#125;<br>    execute () &#123;    <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;命令&#x27;</span>);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">receiver</span>.<span class="hljs-title function_">execute</span>()<br>    &#125;<br>&#125;<br><span class="hljs-comment">// 触发者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Invoker</span> &#123;   <br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">command</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">command</span> = command<br>    &#125;<br>    <span class="hljs-title function_">invoke</span>(<span class="hljs-params"></span>) &#123;   <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;开始&#x27;</span>)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">command</span>.<span class="hljs-title function_">execute</span>()<br>    &#125;<br>&#125;<br>  <br><span class="hljs-comment">// 仓库</span><br><span class="hljs-keyword">const</span> warehouse = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Receiver</span>();   <br><span class="hljs-comment">// 订单    </span><br><span class="hljs-keyword">const</span> order = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Command</span>(warehouse);  <br><span class="hljs-comment">// 客户</span><br><span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Invoker</span>(order);      <br>client.<span class="hljs-title function_">invoke</span>()<br></code></pre></td></tr></table></figure>

<h3 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h3><p>策略模式指的是定义一系列算法，把他们一个个封装起来，目的就是将算法的使用和算法的实现分离开来。同时它还可以用来封装一系列的规则，可以被替换使用。</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ada">let strategies = &#123;<br>  add: <span class="hljs-keyword">function</span> <span class="hljs-title"></span>(num) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">num</span> + num;<br>  &#125;,<br>  multiply: <span class="hljs-keyword">function</span> <span class="hljs-title"></span>(num) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">num</span> * num;<br>  &#125;,<br>&#125;;<br>let calculateBonus = <span class="hljs-keyword">function</span> <span class="hljs-title"></span>(strategy, num) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-type">strategies[strategy](num)</span>;<br>&#125;;<br>console.log(calculateBonus(<span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-number">3</span>));<br>console.log(calculateBonus(<span class="hljs-string">&quot;multiply&quot;</span>, <span class="hljs-number">3</span>));<br></code></pre></td></tr></table></figure>

<h3 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h3><p>定义了一种一对多的关系，让多个观察者对象同时监听某一个主题对象，这个主题对象的状态发生变化时就会通知所有的观察者对象，使它们能够自动更新自己</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Subject</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observers</span> = [];<br>  &#125;<br><br>  <span class="hljs-comment">// 添加观察者</span><br>  <span class="hljs-title function_">addObserver</span>(<span class="hljs-params">observer</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observers</span>.<span class="hljs-title function_">push</span>(observer);<br>  &#125;<br><br>  <span class="hljs-comment">// 移除观察者</span><br>  <span class="hljs-title function_">removeObserver</span>(<span class="hljs-params">observer</span>) &#123;<br>    <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">observers</span>.<span class="hljs-title function_">indexOf</span>(observer);<br>    <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observers</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// 通知观察者</span><br>  <span class="hljs-title function_">notify</span>(<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observers</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">observer</span>) =&gt;</span> &#123;<br>      observer.<span class="hljs-title function_">update</span>(data);<br>    &#125;);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>  <span class="hljs-title function_">update</span>(<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Received data: <span class="hljs-subst">$&#123;data&#125;</span>`</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// 测试代码</span><br><span class="hljs-keyword">const</span> subject = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Subject</span>();<br><span class="hljs-keyword">const</span> observer1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>();<br><span class="hljs-keyword">const</span> observer2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>();<br><br>subject.<span class="hljs-title function_">addObserver</span>(observer1);<br>subject.<span class="hljs-title function_">addObserver</span>(observer2);<br><br>subject.<span class="hljs-title function_">notify</span>(<span class="hljs-string">&#x27;Hello world!&#x27;</span>); <span class="hljs-comment">// Output: Received data: Hello world!</span><br><br>subject.<span class="hljs-title function_">removeObserver</span>(observer1);<br><br>subject.<span class="hljs-title function_">notify</span>(<span class="hljs-string">&#x27;Goodbye world!&#x27;</span>); <span class="hljs-comment">// Output: Received data: Goodbye world!</span><br><br></code></pre></td></tr></table></figure>

<h3 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h3><p>工厂模式是用来创建对象的常见设计模式，在不暴露创建对象的具体逻辑，而是将逻辑进行封装，那么它就可以被称为工厂。工厂模式又叫做静态工厂模式，由一个工厂对象决定创建某一个类的实例。</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ol>
<li>调用者创建对象时只要知道其名称即可</li>
<li>扩展性高，如果要新增一个产品，直接扩展一个工厂类即可。</li>
<li>隐藏产品的具体实现，只关心产品的接口。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DownJacket</span> &#123;<br>  <span class="hljs-title function_">production</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;生产羽绒服&#x27;</span>)<br>  &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Underwear</span>&#123;<br>  <span class="hljs-title function_">production</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;生产内衣&#x27;</span>)<br>  &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TShirt</span>&#123;<br>  <span class="hljs-title function_">production</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;生产t恤&#x27;</span>)<br>  &#125;<br>&#125;<br><span class="hljs-comment">// 工厂类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">clothingFactory</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">downJacket</span> = <span class="hljs-title class_">DownJacket</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">underwear</span> = <span class="hljs-title class_">Underwear</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">t_shirt</span> = <span class="hljs-title class_">TShirt</span><br>  &#125;<br>  <span class="hljs-title function_">getFactory</span>(<span class="hljs-params">clothingType</span>)&#123;<br>    <span class="hljs-keyword">const</span> _production = <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>[clothingType]<br>    <span class="hljs-keyword">return</span> _production.<span class="hljs-title function_">production</span>()<br>  &#125;<br>&#125;<br><span class="hljs-keyword">const</span> clothing = <span class="hljs-keyword">new</span> <span class="hljs-title function_">clothingFactory</span>()<br>clothing.<span class="hljs-title function_">getFactory</span>(<span class="hljs-string">&#x27;t_shirt&#x27;</span>)<span class="hljs-comment">// 生产t恤</span><br></code></pre></td></tr></table></figure>

<h3 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h3><p>例如：Proxy</p>
<p>代理模式的关键是，当客户不方便直接访问一个对象或者不满足需要的时候，提供一个替身对象来控制对这个对象的访问，客户实际上访问的是替身对象。替身对象对请求做出一些处理之后，再把请求转交给本体对象。</p>
<h3 id="装饰者模式"><a href="#装饰者模式" class="headerlink" title="装饰者模式"></a>装饰者模式</h3><p>动态地给某个对象添加一些额外的职责。</p>
<p>在不改变原对象的基础上，通过对其进行包装扩展，使原有对象可以满足用户的更复杂需求，而不会影响从这个类中派生的其他对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cellphone</span> &#123;<br>    <span class="hljs-title function_">create</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;生成一个手机&#x27;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Decorator</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">cellphone</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cellphone</span> = cellphone<br>    &#125;<br>    <span class="hljs-title function_">create</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cellphone</span>.<span class="hljs-title function_">create</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createShell</span>(cellphone)<br>    &#125;<br>    <span class="hljs-title function_">createShell</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;生成手机壳&#x27;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">// 测试代码</span><br><span class="hljs-keyword">let</span> cellphone = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cellphone</span>()<br>cellphone.<span class="hljs-title function_">create</span>()<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;------------&#x27;</span>)<br><span class="hljs-keyword">let</span> dec = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Decorator</span>(cellphone)<br>dec.<span class="hljs-title function_">create</span>()<br></code></pre></td></tr></table></figure>


      </section>
      <section class="extra">
        
          <ul class="copyright">
  
    <li><strong>本文作者：</strong>芝叶</li>
    <li><strong>本文链接：</strong><a href="https://yeatsczx.github.io/2023/04/10/%E6%89%8B%E6%92%95%E4%BB%A3%E7%A0%81/index.html" title="https:&#x2F;&#x2F;yeatsczx.github.io&#x2F;2023&#x2F;04&#x2F;10&#x2F;%E6%89%8B%E6%92%95%E4%BB%A3%E7%A0%81&#x2F;index.html">https:&#x2F;&#x2F;yeatsczx.github.io&#x2F;2023&#x2F;04&#x2F;10&#x2F;%E6%89%8B%E6%92%95%E4%BB%A3%E7%A0%81&#x2F;index.html</a></li>
    <li><strong>版权声明：</strong>本博客所有文章均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" title="BY-NC-SA" target="_blank" rel="noopener">BY-NC-SA</a> 许可协议，转载请注明出处！</li>
  
</ul>
        
        
        
  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%B6%E5%AE%83/" rel="tag">其它</a></li></ul> 

        
  <nav class="nav">
    <a href="/2023/04/11/HTML/"><i class="iconfont iconleft"></i>HTML</a>
    <a href="/2022/08/23/%E6%9A%91%E6%9C%9F%E6%80%BB%E7%BB%93/">暑期总结<i class="iconfont iconright"></i></a>
  </nav>

      </section>
      
    </section>
  </div>
</article></div>
      <div class="col-xl-3">
        
          
  <aside class="toc-wrap">
    <h3 class="toc-title">文章目录：</h3>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Object-create"><span class="toc-text">1.Object.create</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-instanceof"><span class="toc-text">2.instanceof</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-new"><span class="toc-text">3.new</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AE%9E%E7%8E%B0sleep"><span class="toc-text">4.实现sleep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Promise"><span class="toc-text">5.Promise</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Promise-all"><span class="toc-text">6.Promise.all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Promise-race"><span class="toc-text">7.Promise.race</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Promise-prototype-finally"><span class="toc-text">8.Promise.prototype.finally</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Promise-allSettled"><span class="toc-text">9.Promise.allSettled</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-Promise-prototype-catch"><span class="toc-text">10.Promise.prototype.catch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-Promise-resolve"><span class="toc-text">11.Promise.resolve</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-Promise-reject"><span class="toc-text">12.Promise.reject</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81"><span class="toc-text">13.防抖和节流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD%E5%87%BD%E6%95%B0"><span class="toc-text">14.类型判断函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-call-apply-bind"><span class="toc-text">15.call apply bind</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-curry%E6%9F%AF%E9%87%8C%E5%8C%96"><span class="toc-text">16.curry柯里化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-AJAX%E8%AF%B7%E6%B1%82"><span class="toc-text">17.AJAX请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-Promise%E5%B0%81%E8%A3%85AJAX%E8%AF%B7%E6%B1%82"><span class="toc-text">18.Promise封装AJAX请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-%E5%AE%9E%E7%8E%B0%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="toc-text">19.实现浅拷贝</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89Object-assign"><span class="toc-text">（1）Object.assign()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E6%89%A9%E5%B1%95%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">（2）扩展运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0%E6%95%B0%E7%BB%84%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="toc-text">（3）数组方法实现数组浅拷贝</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="toc-text">（4）手写实现浅拷贝</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-%E5%AE%9E%E7%8E%B0%E6%B7%B1%E6%8B%B7%E8%B4%9D"><span class="toc-text">20. 实现深拷贝</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89JSON-stringify"><span class="toc-text">（1）JSON.stringify()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E5%87%BD%E6%95%B0%E5%BA%93lodash%E7%9A%84-cloneDeep%E6%96%B9%E6%B3%95"><span class="toc-text">（2）函数库lodash的_.cloneDeep方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%87%BD%E6%95%B0"><span class="toc-text">（3）手写实现深拷贝函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%87%BD%E6%95%B0"><span class="toc-text">21.日期格式化函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E6%95%B0%E7%BB%84%E7%9A%84%E4%B9%B1%E5%BA%8F%E8%BE%93%E5%87%BA"><span class="toc-text">22.数组的乱序输出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E6%95%B0%E7%BB%84%E7%9A%84%E6%89%81%E5%B9%B3%E5%8C%96"><span class="toc-text">23.数组的扁平化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E9%80%92%E5%BD%92%E5%AE%9E%E7%8E%B0"><span class="toc-text">（1）递归实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89reduce-%E5%87%BD%E6%95%B0%E8%BF%AD%E4%BB%A3"><span class="toc-text">（2）reduce 函数迭代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E6%89%A9%E5%B1%95%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9E%E7%8E%B0"><span class="toc-text">（3）扩展运算符实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%884%EF%BC%89split-%E5%92%8C-toString"><span class="toc-text">（4）split 和 toString</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%885%EF%BC%89ES6-%E4%B8%AD%E7%9A%84-flat"><span class="toc-text">（5）ES6 中的 flat</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D"><span class="toc-text">24.数组去重</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-Array-prototype-flat"><span class="toc-text">25.Array.prototype.flat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-Array-prototype-push"><span class="toc-text">26.Array.prototype.push</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27-Array-prototype-filter"><span class="toc-text">27.Array.prototype.filter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28-Array-prototype-map"><span class="toc-text">28.Array.prototype.map</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29-String-prototype-repeat"><span class="toc-text">29.String.prototype.repeat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#30-%E7%B1%BB%E6%95%B0%E7%BB%84%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E7%BB%84"><span class="toc-text">30.类数组转化为数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#31-%E8%A7%A3%E6%9E%90-URL-Params-%E4%B8%BA%E5%AF%B9%E8%B1%A1"><span class="toc-text">31.解析 URL Params 为对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-%E5%BE%AA%E7%8E%AF%E6%89%93%E5%8D%B0%E7%BA%A2%E9%BB%84%E7%BB%BF"><span class="toc-text">32.循环打印红黄绿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E7%94%A8-callback-%E5%AE%9E%E7%8E%B0"><span class="toc-text">（1）用 callback 实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%94%A8-promise-%E5%AE%9E%E7%8E%B0"><span class="toc-text">（2）用 promise 实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E7%94%A8-async-x2F-await-%E5%AE%9E%E7%8E%B0"><span class="toc-text">（3）用 async&#x2F;await 实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33-%E6%AF%8F%E9%9A%94%E4%B8%80%E7%A7%92%E6%89%93%E5%8D%B0-1-2-3-4"><span class="toc-text">33.每隔一秒打印 1,2,3,4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#34-Promise%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E7%9A%84%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD"><span class="toc-text">34.Promise实现图片的异步加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#35-%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F"><span class="toc-text">35.发布-订阅模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#36-%E5%B0%81%E8%A3%85%E5%BC%82%E6%AD%A5%E7%9A%84fetch%EF%BC%8C%E4%BD%BF%E7%94%A8async-await%E6%96%B9%E5%BC%8F%E6%9D%A5%E4%BD%BF%E7%94%A8"><span class="toc-text">36.封装异步的fetch，使用async await方式来使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#37-%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E8%B7%AF%E7%94%B1"><span class="toc-text">37.实现简单路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#38-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97"><span class="toc-text">38.斐波那契数列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#39-%E4%BD%BF%E7%94%A8-setTimeout-%E5%AE%9E%E7%8E%B0-setInterval"><span class="toc-text">39.使用 setTimeout 实现 setInterval</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#40-jsonp"><span class="toc-text">40.jsonp</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JSONP-%E5%8E%9F%E7%90%86"><span class="toc-text">JSONP 原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#41-%E5%88%A4%E6%96%AD%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8"><span class="toc-text">41.判断对象是否存在循环引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-%E7%BB%A7%E6%89%BF"><span class="toc-text">42.继承</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E7%BB%84%E5%90%88%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-text">寄生组合式继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E9%93%BE%E7%BB%A7%E6%89%BF"><span class="toc-text">原型链继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%BB%A7%E6%89%BF"><span class="toc-text">构造函数继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E7%BB%A7%E6%89%BF"><span class="toc-text">组合继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-text">原型式继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-text">寄生式继承</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43-%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E4%B8%B2%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C"><span class="toc-text">43.异步操作串并行执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%B2%E8%A1%8C%E6%89%A7%E8%A1%8C"><span class="toc-text">串行执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C"><span class="toc-text">并行执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E4%B8%8E%E4%B8%B2%E8%A1%8C%E7%9A%84%E7%BB%93%E5%90%88"><span class="toc-text">并行与串行的结合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%89%81%E5%B9%B3%E5%8C%96"><span class="toc-text">44.对象的扁平化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#45-%E7%89%88%E6%9C%AC%E5%8F%B7%E6%8E%92%E5%BA%8F"><span class="toc-text">45.版本号排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#46-DOM-%E8%8A%82%E7%82%B9%E8%BE%93%E5%87%BA%E4%B8%BA-JSON-%E6%A0%BC%E5%BC%8F"><span class="toc-text">46.DOM 节点输出为 JSON 格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#47-JSON-%E6%A0%BC%E5%BC%8F%E8%BE%93%E5%87%BA%E4%B8%BADOM-%E8%8A%82%E7%82%B9"><span class="toc-text">47.JSON 格式输出为DOM 节点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#48-Array-prototype-reduce"><span class="toc-text">48.Array.prototype.reduce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#49-%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98%EF%BC%88%E6%98%93%E9%94%99%EF%BC%89"><span class="toc-text">49.实现一个事件委托（易错）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#50-%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BB%A3%E7%90%86"><span class="toc-text">50.事件的代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#51-%E5%A4%A7%E6%95%B0%E7%9B%B8%E5%8A%A0"><span class="toc-text">51.大数相加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#52-%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90%E5%8A%9F%E8%83%BD"><span class="toc-text">52.模板字符串解析功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#53-%E5%88%97%E8%A1%A8%E8%BD%AC%E6%88%90%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84"><span class="toc-text">53.列表转成树形结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#54-%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84%E8%BD%AC%E6%88%90%E5%88%97%E8%A1%A8"><span class="toc-text">54.树形结构转成列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55-lodash-get"><span class="toc-text">55.lodash.get</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#56-%E5%B0%86%E6%95%B0%E5%AD%97%E6%AF%8F%E5%8D%83%E5%88%86%E4%BD%8D%E7%94%A8%E9%80%97%E5%8F%B7%E9%9A%94%E5%BC%80"><span class="toc-text">56.将数字每千分位用逗号隔开</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#57-%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="toc-text">57.双向数据绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#58-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-text">58.设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F"><span class="toc-text">发布订阅模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="toc-text">单例模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="toc-text">策略模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-text">观察者模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="toc-text">工厂模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="toc-text">代理模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-text">装饰者模式</span></a></li></ol></li></ol>
  </aside>

        
      </div>
    </div>
  </div>
</main>
  

<footer class="footer">
  <div class="footer-social"><a 
        href="https://github.com/Yeatsczx"
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#9f7be1'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  icongithub-fill "></i>
      </a><a 
        href="mailto:engineerczx@foxmail.com "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#12B7F5'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconmail "></i>
      </a></div>
  
    <div class="footer-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  <a target="_blank" href="https://github.com/Yeatsczx">CZX - 2022</a></p></div>
  
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
  
  
    
<script src="/js/color-mode.js"></script>

  
  
    <div class="search">
  <div class="search-container">
    <div class="search-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <div class="search-input-wrapper">
      <i class="search-input-icon iconfont iconsearch"></i>
      <input class="search-input" type="search" id="search-input" placeholder="Search..." autofocus autocomplete="off"
        autocorrect="off" autocapitalize="off">
    </div>
    <div class="search-output" id="search-output"></div>
  </div>
</div>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>





  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>




  
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>








<script src="/js/utils.js"></script>
<script src="/js/script.js"></script>







  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>



  <script defer src='https://hm.baidu.com/hm.js?cdb8957a9ec8323f89c80310f82d9fb6'></script>











</html>